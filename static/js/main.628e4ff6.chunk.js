(this["webpackJsonpthoth-search"]=this["webpackJsonpthoth-search"]||[]).push([[0],{154:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(12),i=n.n(o),c=n(15),l=n(105),s=Object(l.a)({palette:{background:{default:"#f9f9f9"}}}),d=n(54),u=n(14),j=n(43),b=n(2),v=function(e){var t=e.text;return Object(b.jsxs)(j.a,{variant:"h2",children:["404: ",null!==t&&void 0!==t?t:"page"," not found!"]})},h=n(17),f=n.n(h),p=n(36),m=n(192),g=n(188),O=n(206),x=Object(g.a)((function(e){return{root:{display:"flex",flexDirection:"column",alignItems:"stretch",flexGrow:1}}})),y=function(e){var t=e.onChange,n=e.label,a=e.helperText,r=e.error,o=void 0!==r&&r,i=x();return Object(b.jsx)("div",{className:i.root,children:Object(b.jsx)(O.a,{type:"search",variant:"outlined",label:n,className:i.bar,onChange:function(e){return t(e.target.value)},helperText:a,error:o})})},k=n(74),w=n.n(k),N="https://api.moc.thoth-station.ninja/api/v1",C=n(51),E=n.n(C),B=function(e,t){return w.a.get("https://pypi.org/pypi/"+e+(t?"/"+t:"")+"/json")},S=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"https://pypi.org/simple";return w.a.get(N+"/python/package/dependencies",{params:{name:e,version:t,index:n},headers:{accept:"application/json"}})},A=function(e,t){return w.a.get(N+"/python/package/versions",{params:{name:e},timeout:5e3,headers:{accept:"application/json"}}).then((function(e){if(0===e.data.versions.length)return null;var n=e.data.versions.sort((function(e,t){return E()(e.package_version,t.package_version)}));return t&&n.includes(t)?t:n[n.length-1].package_version})).catch((function(){return null}))},P=Object(g.a)((function(e){return{root:{display:"flex",flexFlow:"column nowrap",alignItems:"center",marginTop:"20%"},search:{display:"flex",justifyContent:"center",alignItems:"stretch",minWidth:"50%"},description:{marginBottom:e.spacing(6),maxWidth:"50%",textAlign:"center"},title:{marginBottom:e.spacing(1)},button:{marginLeft:e.spacing(2)}}})),R=function(){var e=Object(u.f)(),t=P(),n=Object(a.useContext)(st),r=Object(a.useState)(""),o=Object(c.a)(r,2),i=o[0],l=o[1],s=Object(a.useState)(""),d=Object(c.a)(s,2),v=d[0],h=d[1],g=function(){var t=Object(p.a)(f.a.mark((function t(){var a,r,o;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""===i){t.next=19;break}if(!i.includes("github.com")){t.next=5;break}console.log("run thoth analyis"),t.next=19;break;case 5:a=i.split(","),r=!0,o=0;case 8:if(!(o<a.length)){t.next=18;break}return t.next=11,B(a[o]).catch((function(){return h("No results"),!1}));case 11:if(!1!==t.sent){t.next=15;break}return r=!1,t.abrupt("return");case 15:o++,t.next=8;break;case 18:r&&(n({type:"reset"}),1===a.length?e.push("/dashboard/"+a[0]):e.push("/dashboard?packages="+a));case 19:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(b.jsxs)("div",{className:t.root,children:[Object(b.jsx)(j.a,{variant:"h4",className:t.title,children:Object(b.jsx)("b",{children:"Thoth Search"})}),Object(b.jsx)(j.a,{variant:"body1",className:t.description,children:"Use this search box to run analysis on a specific Python package or provide a GitHub link to run analyis on a Python ecosystem. A valid ecosystem will have a properly formatted Pipfile and Pipfile.lock."}),Object(b.jsxs)("div",{className:t.search,children:[Object(b.jsx)(y,{label:"Search for a Python package",onChange:function(e){return function(e){l(e),""!==v&&h("")}(e)},helperText:v,error:""!==v}),Object(b.jsx)(m.a,{variant:"contained",color:"primary",onClick:function(){return g()},className:t.button,children:Object(b.jsx)("b",{children:"Search"})})]})]})},T=n(193),M=n(195),L=n(194),D=Object(g.a)({root:{minWidth:275},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{fontSize:14},pos:{marginBottom:12}}),W=function(e){var t=e.cardMeta,n=e.cardBody,a=D();return Object(b.jsxs)(T.a,{className:a.root,children:[Object(b.jsx)(L.a,{action:t.action,title:t.title,subheader:t.subTitle}),Object(b.jsx)(M.a,{children:n})]})},I=n(41),V=n(5),_=n(196),z=n(210),F=["value","total","label","action"],G=Object(V.a)((function(e){return{root:{height:10,borderRadius:5},colorPrimary:{backgroundColor:e.palette.grey["light"===e.palette.type?200:700]},bar:{borderRadius:5,backgroundColor:"#1a90ff"}}}))(_.a),U=Object(g.a)((function(e){return{root:{display:"grid",gridTemplateColumns:"repeat(6,1fr)",alignItems:"center",gridGap:e.spacing(1)},label:{gridColumnStart:1,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},value:{gridColumnStart:2,textAlign:"end"},bar:{gridColumnStart:"span 3"},end:{gridColumnStart:6}}})),q=function(e){var t=e.value,n=e.total,a=e.label,r=e.action,o=Object(I.a)(e,F),i=U();return Object(b.jsxs)("div",{className:"".concat(i.root," ").concat(o.className),children:[Object(b.jsx)(z.a,{title:a,placement:"left",children:Object(b.jsx)(j.a,{variant:"body2",className:i.label,children:a})}),Object(b.jsx)(j.a,{className:i.value,variant:"body2",children:t}),Object(b.jsx)(G,{variant:"determinate",value:n>0?t/n*100:0,className:i.bar}),Object(b.jsx)("div",{className:i.end,children:null!==r&&void 0!==r?r:null})]})},H=n(197),J=n(191),Y=n(198),K=n(199),Q=Object(g.a)((function(e){return{bar:{marginBottom:e.spacing(1)},header:{marginTop:e.spacing(3)},flex:{display:"flex",flexDirection:"column"}}})),X=function(e){var t,n,a,r,o,i,l=e.metric,s=Q(),d=(null!==(t=l.all.direct)&&void 0!==t?t:0)+(null!==(n=l.all.indirect)&&void 0!==n?n:0)+(null!==(a=l.all.roots)&&void 0!==a?a:0);return Object(b.jsxs)("div",{children:[Object(b.jsx)(j.a,{variant:"body2",gutterBottom:!0,children:Object(b.jsx)("b",{children:"All Packages"})}),Object(b.jsx)(H.a,{className:s.bar}),Object(b.jsx)(q,{value:null!==(r=l.all.roots)&&void 0!==r?r:0,total:d,label:"Root",className:s.bar}),Object(b.jsx)(q,{value:null!==(o=l.all.direct)&&void 0!==o?o:0,total:d,label:"Direct",className:s.bar}),Object(b.jsx)(q,{value:null!==(i=l.all.indirect)&&void 0!==i?i:0,total:d,label:"Indirect"}),Object(b.jsx)(j.a,{variant:"body2",className:s.header,gutterBottom:!0,children:Object(b.jsx)("b",{children:"Root Packages"})}),Object(b.jsx)(H.a,{className:s.bar}),Object(b.jsx)(J.a,{component:"nav",children:Object.entries(l.roots).map((function(e,t){var n,a,r,o,i=Object(c.a)(e,2),d=i[0],u=(i[1],(null!==(n=l.roots[d].direct)&&void 0!==n?n:0)+(null!==(a=l.roots[d].indirect)&&void 0!==a?a:0));return Object(b.jsxs)("div",{children:[Object(b.jsxs)(Y.a,{children:[Object(b.jsx)(K.a,{primary:d}),Object(b.jsxs)("div",{className:s.flex,children:[Object(b.jsx)(q,{value:null!==(r=l.roots[d].direct)&&void 0!==r?r:0,total:u,label:"Direct",className:s.bar}),Object(b.jsx)(q,{value:null!==(o=l.roots[d].indirect)&&void 0!==o?o:0,total:u,label:"Indirect"})]})]}),Object(b.jsx)(H.a,{variant:"middle",className:s.bar})]},d)}))})]})},Z=Object(g.a)((function(e){return{bar:{marginBottom:e.spacing(1)}}})),$=function(e){var t,n,a,r,o=e.metric,i=Z(),c=(null!==(t=o.all.direct)&&void 0!==t?t:0)+(null!==(n=o.all.indirect)&&void 0!==n?n:0);return Object(b.jsxs)("div",{children:[Object(b.jsx)(q,{value:null!==(a=o.all.direct)&&void 0!==a?a:0,total:c,label:"Direct",className:i.bar}),Object(b.jsx)(q,{value:null!==(r=o.all.indirect)&&void 0!==r?r:0,total:c,label:"Indirect"})]})},ee=n(200),te=function(e){var t=e.text;return Object(b.jsx)(j.a,{align:"center",color:"error",variant:"body1",children:t})},ne=Object(g.a)((function(e){return{customProgressRoot:{display:"flex",flexDirection:"column",alignItems:"center"}}})),ae=function(e){var t=e.amount,n=e.note,a=ne();return Object(b.jsxs)("div",{className:a.customProgressRoot,children:[Object(b.jsx)(ee.a,{variant:t?"determinate":"indeterminate",value:null!==t&&void 0!==t?t:0}),n?Object(b.jsx)(j.a,{align:"center",variant:"body1",children:n}):null]})},re=function(e){var t=e.children,n=e.state,a=e.errorText,r=e.show404,o=e.loadingPage,i=e.amount,c=e.note;return Object(b.jsx)(b.Fragment,{children:"error"===n?r?Object(b.jsx)(v,{text:r}):Object(b.jsx)(te,{text:null!==a&&void 0!==a?a:"A unknown error occured"}):void 0===n?null!==o&&void 0!==o?o:Object(b.jsx)(ae,{amount:i,note:c}):t})},oe=function(){var e,t,n,r,o=Object(a.useContext)(lt);return Object(b.jsx)(re,{state:o.error?"error":o.metrics.dependencies.all.roots,amount:null===o||void 0===o||null===(e=o.loading)||void 0===e||null===(t=e.init)||void 0===t?void 0:t.amount,note:null===o||void 0===o||null===(n=o.loading)||void 0===n||null===(r=n.init)||void 0===r?void 0:r.note,children:1===o.roots.length?Object(b.jsx)($,{metric:o.metrics.dependencies}):Object(b.jsx)(X,{metric:o.metrics.dependencies})})},ie=n(201),ce=n(211),le=n(207),se=n(100),de=n.n(se),ue=n(101),je=n.n(ue),be=Object(g.a)((function(e){return{bar:{marginBottom:e.spacing(1)},marginBottom:{marginBottom:e.spacing(2)},chip:{margin:e.spacing(.5)},border:{marginTop:e.spacing(1),marginBottom:e.spacing(1)}}})),ve=function(e){var t,n=e.name,a=e.value,o=e.totalLicenses,i=be(),l=r.a.useState(!1),s=Object(c.a)(l,2),d=s[0],u=s[1];return Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{className:i.flex,onClick:function(){return u(!d)},children:Object(b.jsx)(q,{value:null!==(t=Object.keys(a).length)&&void 0!==t?t:0,total:o,label:n,className:i.bar,action:d?Object(b.jsx)(de.a,{}):Object(b.jsx)(je.a,{})},n)}),Object(b.jsxs)(ie.a,{in:d,timeout:"auto",unmountOnExit:!0,children:[Object(b.jsx)("div",{className:i.border,children:Object.entries(a).sort((function(e,t){return e[1]-t[1]})).map((function(e){var t=Object(c.a)(e,2),n=t[0],a=t[1];return Object(b.jsx)(ce.a,{className:i.chip,color:0===a?"primary":1===a?"secondary":"default",label:n,onClick:null},n)}))}),Object(b.jsx)(H.a,{})]})]})},he=function(e){var t,n,a=e.metric,o=e.deepError,i=be(),l=r.a.useState(!1),s=Object(c.a)(l,2),d=s[0],u=s[1],v=Object.entries(null!==(t=null===a||void 0===a?void 0:a.all)&&void 0!==t?t:{}).sort((function(e,t){return Object.keys(t[1]).length-Object.keys(e[1]).length})),h=Object.entries(null!==(n=null===a||void 0===a?void 0:a.all)&&void 0!==n?n:{}).reduce((function(e,t){return e+Object.keys(t[1]).length}),0);return Object(b.jsxs)("div",{className:i.root,children:[Object(b.jsx)(j.a,{variant:"body2",gutterBottom:!0,children:Object(b.jsx)("b",{children:"Dependency Licenses"})}),Object(b.jsx)(H.a,{}),Object(b.jsxs)(re,{state:o?"error":a.all,errorText:"Could not run analysis on dependencies.",children:[v.slice(0,10).map((function(e){var t=Object(c.a)(e,2),n=t[0],a=t[1];return Object(b.jsx)(ve,{name:n,value:a,totalLicenses:h},n)})),Object(b.jsx)(ie.a,{in:d,timeout:"auto",unmountOnExit:!0,children:v.slice(10).map((function(e){var t=Object(c.a)(e,2),n=t[0],a=t[1];return Object(b.jsx)(ve,{name:n,value:a,totalLicenses:h},n)}))}),Object(b.jsx)(le.a,{textAlign:"center",children:Object(b.jsx)(m.a,{onClick:function(){return u(!d)},color:"primary",children:d?"Less":"More"})})]})]})},fe=Object(g.a)((function(e){return{bar:{marginBottom:e.spacing(1)},marginBottom:{marginBottom:e.spacing(2)}}})),pe=function(e){var t,n=e.metric,a=fe();return Object(b.jsxs)("div",{className:a.root,children:[Object(b.jsx)(j.a,{variant:"body2",gutterBottom:!0,children:Object(b.jsx)("b",{children:"License"})}),Object(b.jsx)(H.a,{}),Object(b.jsx)(j.a,{className:a.marginBottom,variant:"h6",children:n.root}),Object(b.jsx)(j.a,{variant:"body2",gutterBottom:!0,children:Object(b.jsx)("b",{children:"Dependency Licenses"})}),Object(b.jsx)(H.a,{}),Object.entries(null!==(t=null===n||void 0===n?void 0:n.all)&&void 0!==t?t:{}).map((function(e){var t,r=Object(c.a)(e,2),o=r[0],i=r[1];return Object(b.jsx)(q,{value:null!==(t=Object.keys(i).length)&&void 0!==t?t:0,total:n.total,label:o,className:a.bar},o)}))]})},me=function(){var e,t,n,r,o=Object(a.useContext)(lt);return Object(b.jsx)(re,{state:o.error?"error":o.metrics.licenses.total,amount:null===o||void 0===o||null===(e=o.loading)||void 0===e||null===(t=e.init)||void 0===t?void 0:t.amount,note:null===o||void 0===o||null===(n=o.loading)||void 0===n||null===(r=n.init)||void 0===r?void 0:r.note,children:1===o.roots.length?Object(b.jsx)(pe,{metric:o.metrics.licenses}):Object(b.jsx)(he,{metric:o.metrics.licenses})})},ge=n(202),Oe=function(){var e=Object(a.useContext)(lt);return Object(b.jsx)(ge.a,{container:!0,spacing:3,children:Object.keys(e.metrics).map((function(e){return Object(b.jsx)(ge.a,{item:!0,xs:12,sm:6,children:Object(b.jsx)(W,{cardMeta:{title:e.charAt(0).toUpperCase()+e.slice(1)},cardBody:"dependencies"===e?Object(b.jsx)(oe,{}):"licenses"===e?Object(b.jsx)(me,{}):null})},e)}))})},xe=n(102),ye=n.n(xe),ke=n(103),we=n.n(ke),Ne=["text","icon","link"],Ce=Object(g.a)((function(e){return{root:{display:"flex"}}})),Ee=function(e){var t=e.text,n=e.icon,a=e.link,r=Object(I.a)(e,Ne),o=Ce();return Object(b.jsxs)("div",{className:"".concat(o.root," ").concat(r.className),children:[n,Object(b.jsx)(j.a,{href:a||null,variant:"body2",align:"center",children:t})]})};function Be(e){var t=Math.floor((new Date-e)/1e3),n=t/31536e3;if(n>1){var a=Math.floor(n);return a+" year"+(1!==a?"s":"")}if((n=t/2592e3)>1){var r=Math.floor(n);return r+" month"+(1!==r?"s":"")}if((n=t/86400)>1){var o=Math.floor(n);return o+" day"+(1!==o?"s":"")}if((n=t/3600)>1){var i=Math.floor(n);return i+" hour"+(1!==i?"s":"")}if((n=t/60)>1){var c=Math.floor(n);return c+" minute"+(1!==c?"s":"")}var l=Math.floor(t);return l+" second"+(1!==l?"s":"")}var Se=Object(g.a)((function(e){return{titleRow:{display:"flex",alignItems:"center",marginBottom:e.spacing(1)},marginLeft:{marginLeft:e.spacing(2)},marginRight:{marginRight:e.spacing(2)},linksRow:{display:"flex",marginBottom:e.spacing(3)},warning:{display:"flex"}}})),Ae=function(){var e,t,n,r,o,i,c,l,s,d,u,v,h,f,p,m,g,O,x,y,k,w,N,C=Se(),E=Object(a.useContext)(lt),B=E.roots,S=E.packageWarning;return Object(b.jsxs)("div",{children:[Object(b.jsxs)("div",{className:C.titleRow,children:[Object(b.jsx)(j.a,{variant:"h4",children:Object(b.jsx)("b",{children:null===(e=B[0])||void 0===e||null===(t=e.metadata)||void 0===t||null===(n=t.info)||void 0===n?void 0:n.name})}),Object(b.jsxs)(j.a,{className:C.marginLeft,variant:"subtitle1",children:["v",null!==(r=null===(o=B[0])||void 0===o||null===(i=o.metadata)||void 0===i||null===(c=i.info)||void 0===c?void 0:c.version)&&void 0!==r?r:"NaN"]})]}),Object(b.jsx)(j.a,{gutterBottom:!0,variant:"body1",children:null!==(l=null===(s=B[0])||void 0===s||null===(d=s.metadata)||void 0===d||null===(u=d.info)||void 0===u?void 0:u.summary)&&void 0!==l?l:"NaN"}),Object(b.jsxs)("div",{className:C.linksRow,children:[Object(b.jsx)(Ee,{text:null!==(v=null===(h=B[0])||void 0===h||null===(f=h.metadata)||void 0===f||null===(p=f.info)||void 0===p?void 0:p.license)&&void 0!==v?v:"NaN",icon:Object(b.jsx)(ye.a,{})}),Object(b.jsx)(Ee,{className:C.marginLeft,text:"Latest version published "+Be(new Date(null===(m=B[0])||void 0===m||null===(g=m.metadata)||void 0===g||null===(O=g.releases)||void 0===O||null===(x=O[null===(k=B[0])||void 0===k||null===(w=k.metadata)||void 0===w||null===(N=w.info)||void 0===N?void 0:N.version])||void 0===x||null===(y=x[0])||void 0===y?void 0:y.upload_time))+" ago.",icon:Object(b.jsx)(we.a,{})})]}),S&&0!==S.length?S.map((function(e){return Object(b.jsxs)(j.a,{gutterBottom:!0,color:"error",className:C.marginRight,variant:"body2",children:["Dependency ",Object(b.jsx)("i",{children:S[0].value.label})," ",Object(b.jsx)("i",{children:S[0].value.metadata.info.version})," is currently not supported by Thoth."]})})):null]})},Pe=n(11),Re=["children","value","index"],Te=function(e){var t=e.children,n=e.value,a=e.index,r=Object(I.a)(e,Re);return Object(b.jsx)("div",Object(Pe.a)(Object(Pe.a)({role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},r),{},{children:n===a&&Object(b.jsx)(le.a,{children:t})}))},Me=n(26);function Le(e,t,n){var a=n.filter((function(t){return e.includes(t.from)})),r={nodes:[],edges:[]};return a.forEach((function(e){var a=De(e,{nodes:[],edges:[]},n,t);r={nodes:Object(Me.a)(new Set([].concat(Object(Me.a)(a.nodes),Object(Me.a)(r.nodes)))),edges:Object(Me.a)(new Set([].concat(Object(Me.a)(a.edges),Object(Me.a)(r.edges))))}})),r}function De(e,t,n,a){if(t.edges.includes(e.id))return t;if(t.nodes.push(e.from,e.to),t.edges.push(e.id),e.to===a)return t;var r={nodes:[],edges:[]};return n.filter((function(t){return t.from===e.to})).forEach((function(e){var o=De(e,t,n,a);r={nodes:Object(Me.a)(new Set([].concat(Object(Me.a)(o.nodes),Object(Me.a)(r.nodes)))),edges:Object(Me.a)(new Set([].concat(Object(Me.a)(o.edges),Object(Me.a)(r.edges))))}})),r}var We={manipulation:{enabled:!1,editNode:function(e,t){e.fixed=!e.fixed.x,t(e)}},interaction:{hover:!0,hoverConnectedEdges:!1,selectConnectedEdges:!1,selectable:!1},edges:{chosen:!1,smooth:!1,color:{color:"#5c6470"},arrowStrikethrough:!1,arrows:{from:{enabled:!0,type:"triangle"}}},nodes:{chosen:!1,color:{background:"#5c6470",border:"#fff",hover:{background:"#f39200",border:"#fff"}},shape:"dot",size:10,borderWidth:2,labelHighlightBold:!1,font:{color:"#393e46",strokeWidth:2,size:15}},physics:{hierarchicalRepulsion:{damping:.1,springLength:200},solver:"hierarchicalRepulsion",minVelocity:.15}},Ie=n(58),Ve=["data","searchText","root"],_e=Object(g.a)((function(e){return{root:{display:"flex",flexFlow:"column nowrap"},canvas:{flex:"1 1 auto",height:"75vh"}}})),ze=function(e){var t=e.data,n=(e.searchText,e.root),r=Object(I.a)(e,Ve),o=Object(a.useRef)(null),i=_e();Object(a.useEffect)((function(){var e=o.current&&new Ie.b(o.current,t,We),a=t.nodes.get(n);a.color="#4fc1ea",a.font={color:"#4fc1ea",strokeWidth:3,size:20},t.nodes.updateOnly(a);var r=document.getElementById("mynetwork").getElementsByTagName("canvas")[0];function i(e){r.style.cursor=e}e.on("hoverNode",(function(){i("grab")})),e.on("blurNode",(function(){i("default")})),e.on("dragStart",(function(){i("grabbing")})),e.on("dragging",(function(){i("grabbing")})),e.on("dragEnd",(function(){i("grab")})),e.on("dragEnd",(function(t){0!==t.nodes.length&&e.editNode(t.nodes[0])})),e.on("dragStart",(function(t){0!==t.nodes.length&&void 0!==e.body.nodes[t.nodes[0]].options.x&&e.body.nodes[t.nodes[0]].options.x&&e.editNode(t.nodes[0])}))}),[o,t,n]);return Object(b.jsxs)("div",{className:"".concat(i.root," ").concat(r.className),children:[Object(b.jsx)(y,{label:"Filter packages",onChange:function(e){return function(e,t){if(t.nodes.updateOnly(t.nodes.get().map((function(e){return e.id!==n&&(e.color=We.nodes.color,e.font=We.nodes.font),e}))),t.edges.updateOnly(t.edges.get().map((function(e){return e.color=We.edges.color,e}))),""!==e){var a=t.nodes.get({filter:function(t){return t.label.includes(e)}}),r=Le(a.map((function(e){return e.id})),n,t.edges.map((function(e){return e}))),o=t.edges.get().filter((function(e){return!r.edges.includes(e.id)})).map((function(e){return e.color={color:"#e3e5e8"},e})),i=t.nodes.get().filter((function(e){return!r.nodes.includes(e.id)})).map((function(e){return e.id!==n&&(e.color={background:"#e3e5e8"},e.font={color:"#e3e5e8",strokeWidth:2,size:15}),e}));a=a.map((function(e){return e.id!==n&&(e.color={background:"#f39200"}),e})),t.nodes.updateOnly(i.concat(a)),t.edges.updateOnly(o)}}(e,t)}}),Object(b.jsx)("div",{ref:o,id:"mynetwork",className:i.canvas})]})},Fe=n(34),Ge=n(104),Ue=n(72),qe=n(73),He=function(){function e(t,n){Object(Ue.a)(this,e),this.adjacents=new Set,this.key=t,this.value=n}return Object(qe.a)(e,[{key:"addAdjacent",value:function(e){this.adjacents.add(e)}},{key:"isAdjacent",value:function(e){return this.adjacents.has(e)}},{key:"getAdjacents",value:function(){return Array.from(this.adjacents)}}]),e}(),Je=function(){function e(){Object(Ue.a)(this,e),this.nodes=new Map}return Object(qe.a)(e,[{key:"addVertex",value:function(e,t){if(this.nodes.has(e))return this.nodes.get(e);var n=new He(e,t);return this.nodes.set(e,n),n}},{key:"addEdge",value:function(e,t){var n=this.nodes.get(e),a=this.nodes.get(t);return n.addAdjacent(a),[n,a]}},{key:"areAdjacents",value:function(e,t){var n=this.nodes.get(e),a=this.nodes.get(t);return!(!n||!a)&&n.isAdjacent(a)}},{key:"graphSearch",value:f.a.mark((function e(t){var n,a,r,o,i=arguments;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=i.length>1&&void 0!==i[1]?i[1]:"bfs",a=new Map,(r=[]).push(t);case 4:if(0===r.length){e.next=13;break}if(!(o="dfs"===n?r.pop():r.shift())||a.has(o)){e.next=11;break}return e.next=9,o;case 9:a.set(o),o.getAdjacents().forEach((function(e){return r.push(e)}));case 11:e.next=4;break;case 13:case"end":return e.stop()}}),e)}))},{key:"findPath",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,a=this.nodes.get(e),r=this.nodes.get(t),o=new Map(n);if(!r||!a)return[];if(o.set(a),e===t)return Array.from(o.keys());var i,c=Object(Ge.a)(a.getAdjacents());try{for(c.s();!(i=c.n()).done;){var l=i.value;if(!o.has(l)){var s=this.findPath(l.value,t,o);if(s.length)return s}}}catch(d){c.e(d)}finally{c.f()}return[]}},{key:"findAllPaths",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=this.nodes.get(e),o=this.nodes.get(t),i=new Map(a);if(!o||!r)return[];if(i.set(r),e===t)return[Array.from(i.keys())];var c=[];return r.getAdjacents().forEach((function(e){i.has(e)||n.findAllPaths(e.value,t,i).forEach((function(e){return c.push(e)}))})),c}}]),e}();function Ye(e,t){return Ke.apply(this,arguments)}function Ke(){return(Ke=Object(p.a)(f.a.mark((function e(t,n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B(t,n).then(function(){var e=Object(p.a)(f.a.mark((function e(a){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(t,n).then((function(e){return null===e?{metadata:a.data,error:"Thoth currently does not support '"+a.data.info.name+"'."}:E()(a.data.info.version,e)>0?{metadata:a.data,thothVersion:e,error:"Thoth currently supports '"+a.data.info.name+"' up to version "+e+", while the most recent version of '"+a.data.info.name+"' is "+a.data.info.version+"."}:{metadata:a.data}})).catch((function(){return null}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(){return null}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Qe=n(156),Xe=Object(g.a)((function(e){return{graph:{padding:e.spacing(4)}}})),Ze=function(){var e,t,n,r,o,i,l=Xe(),s=Object(a.useContext)(lt),d=s.roots.length>1?"*App":(null===(e=s.roots[0])||void 0===e||null===(t=e.metadata)||void 0===t||null===(n=t.info)||void 0===n?void 0:n.name)+(null===(r=s.roots[0])||void 0===r||null===(o=r.metadata)||void 0===o||null===(i=o.info)||void 0===i?void 0:i.version),u=function(e,t){var n=Object(a.useState)(void 0),r=Object(c.a)(n,2),o=r[0],i=r[1];return Object(a.useEffect)((function(){if(e&&t){var n={nodes:[],edges:[]},a=t.graphSearch(t.nodes.get(e));Array.from(a).forEach((function(e){n.nodes.push({id:e.value.id,label:e.value.label}),e.adjacents.forEach((function(t){n.edges.push({to:e.value.id,from:t.value.id})}))})),i(n)}}),[e,t]),o}(d,s.graph);return Object(b.jsx)(re,{state:s.thothError?"error":u,errorText:"Could not load in dependency graph.",children:Object(b.jsx)(Qe.a,{children:Object(b.jsx)(ze,{data:{nodes:new Ie.a(null===u||void 0===u?void 0:u.nodes),edges:new Ie.a(null===u||void 0===u?void 0:u.edges)},className:l.graph,root:d})})})},$e=n(208),et=n(203),tt=Object(g.a)((function(e){return{root:{flexGrow:1,maxWidth:"95%",marginLeft:"auto",marginRight:"auto",paddingRight:e.spacing(3),paddingLeft:e.spacing(3),marginTop:e.spacing(4)}}})),nt=function(e){e.location;var t,n,r=tt(),o=Object(u.h)(),i=Object(a.useContext)(lt),l=Object(u.g)().search,s=Object(a.useState)(0),d=Object(c.a)(s,2),v=d[0],h=d[1],m=Object(a.useState)(null),g=Object(c.a)(m,2),O=g[0],x=g[1];Object(a.useEffect)((function(){var e,t,n=null===(e=new URLSearchParams(l).get("packages"))||void 0===e?void 0:e.split(","),a=null===n||void 0===n?void 0:n.map((function(e){return{name:e,version:void 0}}));a=null!==(t=a)&&void 0!==t?t:[{name:o.package,version:null===o||void 0===o?void 0:o.version}],x(a)}),[o.package,o.version,l]),function(e){var t=Object(a.useContext)(st);Object(a.useEffect)((function(){if(e){var n=e.map(function(){var e=Object(p.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ye(t.name,null===t||void 0===t?void 0:t.version));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());Promise.all(n).then((function(e){1===e.length&&null===e[0]?t({type:"packageError",payload:"Package does not exist"}):t({type:"roots",payload:e})}))}}),[e,t])}(O),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=Object(a.useContext)(st);Object(a.useEffect)((function(){if(e&&0!==e.length){n({type:"loading",payload:{init:{amount:0,note:"Building dependency graph."}}});var a=0,r=0,o=new Je,i=new Map,c=[];if(e.length>1){var l={id:"*App",label:"App",depth:-1},s=o.addVertex(l.id,l);e.forEach((function(e){var t,n,r;if(!e.error){a+=null!==(t=null===(n=e.metadata.info)||void 0===n||null===(r=n.requires_dist)||void 0===r?void 0:r.length)&&void 0!==t?t:0;var i={id:e.metadata.info.name+e.metadata.info.version,label:e.metadata.info.name,depth:0,metadata:e.metadata},l=o.addVertex(i.id,i);o.addEdge(s.key,l.key),c.push(l)}}))}else{var d,u,j;if(e[0].error)return;a=null!==(d=null===(u=e[0].metadata.info)||void 0===u||null===(j=u.requires_dist)||void 0===j?void 0:j.length)&&void 0!==d?d:0;var b={id:e[0].metadata.info.name+e[0].metadata.info.version,label:e[0].metadata.info.name,depth:0,metadata:e[0].metadata},v=o.addVertex(b.id,b);c.push(v)}Object(p.a)(f.a.mark((function e(){var l;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l=f.a.mark((function e(){var l;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(l=c.pop())||i.has(l)){e.next=7;break}if(i.set(l),1===l.value.depth&&n({type:"loading",payload:{init:{amount:(r+=1)/a*100,note:"Building dependency graph :: "+l.value.label}}}),l.value.depth===t){e.next=7;break}return e.next=7,S(l.value.metadata.info.name,l.value.metadata.info.version).then(function(){var e=Object(p.a)(f.a.mark((function e(t){var n,a,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.data.dependencies.sort((function(e,t){return E()(e.version,t.version)})),a=[],r=n.length-1;case 3:if(!(r>=0)){e.next=11;break}if(a.includes(n[r].name)){e.next=8;break}return a.push(n[r].name),e.next=8,B(n[r].name,n[r].version).then((function(e){var t={id:e.data.info.name+e.data.info.version,label:e.data.info.name,depth:l.value.depth+1,metadata:e.data},n=o.addVertex(t.id,t);o.addEdge(l.key,n.key),c.push(n)}));case 8:r--,e.next=3;break;case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){var t;404!==(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.status)||(l.value.thoth=!1)}));case 7:case"end":return e.stop()}}),e)}));case 1:if(0===c.length){e.next=5;break}return e.delegateYield(l(),"t0",3);case 3:e.next=1;break;case 5:case"end":return e.stop()}}),e)})))().then((function(){n({type:"graph",payload:o})}))}}),[e,n,t])}(i.roots,2),function(e,t){var n=Object(a.useContext)(st);Object(a.useEffect)((function(){if(e&&t){var a={all:{},roots:{}},r={total:void 0,all:{}},o=[],i=e;"string"===typeof i&&(i=[e]),i.forEach((function(e){if(!e.error){var n=t.graphSearch(t.nodes.get(e.metadata.info.name+e.metadata.info.version));Array.from(n).forEach((function(t){var n,i,c,l,s,d,u,j,b=0===t.value.depth?"roots":1===t.value.depth?"direct":"indirect";!1===t.value.thoth&&o.push(t),a={all:Object(Pe.a)(Object(Pe.a)({},a.all),{},Object(Fe.a)({},b,(null!==(n=a.all[b])&&void 0!==n?n:0)+1)),roots:Object(Pe.a)(Object(Pe.a)({},a.roots),{},Object(Fe.a)({},e.metadata.info.name+e.metadata.info.version,Object(Pe.a)(Object(Pe.a)({},null!==(i=a.roots[e.metadata.info.name+e.metadata.info.version])&&void 0!==i?i:null),{},Object(Fe.a)({},b,(null!==(c=null===(l=a.roots)||void 0===l||null===(s=l[e.metadata.info.name+e.metadata.info.version])||void 0===s?void 0:s[b])&&void 0!==c?c:0)+1))))},r={total:(null!==(d=r.total)&&void 0!==d?d:0)+1,root:null!==(u=r.root)&&void 0!==u?u:t.value.metadata.info.license,all:Object(Pe.a)(Object(Pe.a)({},r.all),{},Object(Fe.a)({},t.value.metadata.info.license,Object(Pe.a)(Object(Pe.a)({},null!==(j=r.all[t.value.metadata.info.license])&&void 0!==j?j:null),{},Object(Fe.a)({},t.value.label,t.value.depth))))}}))}})),n({type:"metric",metric:"dependencies",payload:a}),n({type:"metric",metric:"licenses",payload:r}),n({type:"packageWarning",payload:o})}}),[t,e,n])}(i.roots,i.graph);return Object(b.jsx)(re,{state:i.packageError?"error":i.roots,show404:"Package",children:Object(b.jsxs)("div",{className:r.root,children:[1===(null===i||void 0===i||null===(t=i.roots)||void 0===t?void 0:t.length)?Object(b.jsx)(Ae,{}):null,null===i||void 0===i||null===(n=i.roots)||void 0===n?void 0:n.map((function(e){return e.error?Object(b.jsx)(j.a,{color:"error",gutterBottom:!0,variant:"body2",children:e.error}):null})),Object(b.jsxs)($e.a,{value:v,onChange:function(e,t){h(t)},indicatorColor:"primary",textColor:"primary",children:[Object(b.jsx)(et.a,{label:"Overview"}),Object(b.jsx)(et.a,{label:"Dependencies"})]}),Object(b.jsx)(Te,{value:v,index:0,children:Object(b.jsx)(Oe,{})}),Object(b.jsx)(Te,{value:v,index:1,children:Object(b.jsx)(Ze,{})})]})})},at=function(){return Object(b.jsxs)(u.c,{children:[Object(b.jsx)(u.a,{exact:!0,path:"/",component:R}),Object(b.jsx)(u.a,{exact:!0,path:"/dashboard/:package?/:version?",component:nt}),Object(b.jsx)(u.a,{path:"*",status:404,children:Object(b.jsx)(v,{})})]})},rt=n(204),ot=n(205);function it(e,t){switch(t.type){case"graph":return Object(Pe.a)(Object(Pe.a)({},e),{},{graph:t.payload});case"roots":return Object(Pe.a)(Object(Pe.a)({},e),{},{roots:t.payload});case"metric":return Object(Pe.a)(Object(Pe.a)({},e),{},{metrics:Object(Pe.a)(Object(Pe.a)({},e.metrics),{},Object(Fe.a)({},t.metric,t.payload))});case"packageError":case"thothError":return Object(Pe.a)(Object(Pe.a)({},e),{},{error:t.payload});case"loading":return Object(Pe.a)(Object(Pe.a)({},e),{},{loading:t.payload});case"packageWarning":return Object(Pe.a)(Object(Pe.a)({},e),{},{packageWarning:t.payload});case"reset":return ct;default:return e}}var ct={graph:void 0,roots:void 0,metrics:{dependencies:{all:{},roots:{}},licenses:{total:void 0,all:{}}},error:!1},lt=r.a.createContext(),st=r.a.createContext();var dt=function(){var e=Object(a.useReducer)(it,ct),t=Object(c.a)(e,2),n=t[0],r=t[1];return Object(b.jsxs)(rt.a,{theme:s,children:[Object(b.jsx)(ot.a,{}),Object(b.jsx)(d.a,{basename:"/thoth-search",children:Object(b.jsx)(lt.Provider,{value:n,children:Object(b.jsx)(st.Provider,{value:r,children:Object(b.jsx)(at,{})})})})]})};i.a.render(Object(b.jsx)(r.a.StrictMode,{children:Object(b.jsx)(dt,{})}),document.getElementById("root"))}},[[154,1,2]]]);
//# sourceMappingURL=main.628e4ff6.chunk.js.map