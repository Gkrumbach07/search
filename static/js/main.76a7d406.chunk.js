(this["webpackJsonpthoth-search"]=this["webpackJsonpthoth-search"]||[]).push([[0],{198:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n.n(a),r=n(57),c=n.n(r),o=n(10),l=n(137),s=Object(l.a)({palette:{background:{default:"#f9f9f9"}}}),d=n(75),u=n(19),j=n(98),v=n(0),b=function(e){var t=e.text;return Object(v.jsxs)(j.a,{variant:"h2",children:["404: ",null!==t&&void 0!==t?t:"page"," not found!"]})},h=n(22),p=n.n(h),f=n(50),m=n(295),O=n(300),x=n(301),g=n(293),y=n(273),k=n(272),w=n(279),C=n(16),N=n(281),E=Object(w.a)((function(e){return{root:{display:"flex",flexDirection:"column",alignItems:"stretch",flexGrow:1}}})),S=function(e){var t=e.onChange,n=e.label,a=e.helperText,i=e.boxprops,r=e.error,c=void 0!==r&&r,o=E();return Object(v.jsx)(m.a,Object(C.a)(Object(C.a)({className:o.root},i),{},{children:Object(v.jsx)(N.a,Object(C.a)({variant:"outlined",label:n,onChange:function(e){return t(e.target.value)},helperText:a,error:c},e))}))},P=n(45),_=["children","value","index"],B=function(e){var t=e.children,n=e.value,a=e.index,i=Object(P.a)(e,_);return Object(v.jsx)("div",Object(C.a)(Object(C.a)({role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a),className:"".concat(i.className)},i),{},{children:n===a&&t}))},L=n(51),A=n.n(L),R="https://pypi.org/pypi",I="https://api.moc.thoth-station.ninja/api/v1",T=n(93),M=n.n(T);function D(){return(e="https://raw.githubusercontent.com/spdx/license-list-data/master/json/licenses.json",fetch(e).then((function(e){return e.text()})).then((function(e){return e}))).then((function(e){return JSON.parse(e)}));var e}var G=function(e,t){return A.a.get(R+"/"+e+(t?"/"+t:"")+"/json")},q=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"https://pypi.org/simple";return A.a.get(I+"/python/package/metadata",{params:{name:e,version:t,index:n},headers:{accept:"application/json"}}).then((function(e){return e.data.metadata})).catch((function(n){var a;if(404===(null===n||void 0===n||null===(a=n.response)||void 0===a?void 0:a.status))return A.a.get(R+"/"+e+(t?"/"+t:"")+"/json").then((function(e){return e.data.info}));throw n}))},z=function(e,t){var n={application_stack:{requirements:e,requirements_format:"pipenv",requirements_lock:t},runtime_environment:{operating_system:{name:"ubi",version:"8"},platform:"linux-x86_64",python_version:"3.6"}};return A.a.post(I+"/advise/python",n,{params:{recommendation_type:"stable"},headers:{accept:"application/json"}})},W=function(e,t){return A.a.get(I+"/python/package/versions",{params:{name:e},timeout:5e3,headers:{accept:"application/json"}}).then((function(e){if(0===e.data.versions.length)return null;var n=e.data.versions.sort((function(e,t){return M()(e.package_version,t.package_version)}));return t&&n.includes(t)?t:n[n.length-1].package_version})).catch((function(){return null}))};function F(e,t){return J.apply(this,arguments)}function J(){return(J=Object(f.a)(p.a.mark((function e(t,n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G(t,n).then(function(){var e=Object(f.a)(p.a.mark((function e(a){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W(t,n).then((function(e){return null===e?{metadata:a.data,error:"Thoth currently does not support '"+a.data.info.name+"'."}:M()(a.data.info.version,e)>0?{metadata:a.data,thothVersion:e,error:"Thoth currently supports '"+a.data.info.name+"' up to version "+e+", while the most recent version of '"+a.data.info.name+"' is "+a.data.info.version+"."}:{metadata:a.data}})).catch((function(){return null}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(){return null}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var V=Object(w.a)((function(e){return{root:{display:"flex",flexFlow:"column nowrap",alignItems:"center",marginTop:"10%"},stretchContent:{minWidth:"50%"},searchBar:{display:"flex",justifyContent:"center"},flexColumn:{display:"flex",flexDirection:"column"},multilineTextBoxContainer:{display:"flex",justifyContent:"space-between"},description:{marginBottom:e.spacing(1),maxWidth:"50%",textAlign:"center"},mode:{marginBottom:e.spacing(3)},title:{marginBottom:e.spacing(1)}}})),U=function(){var e=Object(u.f)(),t=V(),n=Object(a.useContext)(ln),i=Object(a.useState)(""),r=Object(o.a)(i,2),c=r[0],l=r[1],s=Object(a.useState)(""),d=Object(o.a)(s,2),b=d[0],h=d[1],w=Object(a.useState)(""),C=Object(o.a)(w,2),N=C[0],E=C[1],P=Object(a.useState)(""),_=Object(o.a)(P,2),L=_[0],A=_[1],R=Object(a.useState)(""),I=Object(o.a)(R,2),T=I[0],M=I[1],D=Object(a.useState)(""),G=Object(o.a)(D,2),q=G[0],W=G[1],J=Object(a.useState)("multiple"),U=Object(o.a)(J,2),H=U[0],K=U[1],Y=Object(a.useState)(!1),Z=Object(o.a)(Y,2),Q=Z[0],X=Z[1],$=Object(a.useState)(!1),ee=Object(o.a)($,2),te=ee[0],ne=ee[1],ae=function(e,t){switch(t){case"single":l(e.target.value),""!==L&&A("");break;case"pipfile":h(e.target.value),""!==T&&M("");break;case"lock":E(e.target.value),""!==q&&W("")}},ie=function(){var t=Object(f.a)(p.a.mark((function t(){var a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("single"!==H){t.next=6;break}if(""!==c){t.next=3;break}return t.abrupt("return");case 3:F(c).then((function(){})).catch((function(){A("Package does not exist")})),t.next=12;break;case 6:if(""!==b&&""!==N&&""===T&&""===q){t.next=8;break}return t.abrupt("return");case 8:a=!1,b||(a=!0,M("Please provide a Pipfile")),N||(a=!0,W("Please provide a Pipfile.lock")),a||(ne(!0),z(b,N).then((function(t){ne(!1),n({type:"advise",param:"analysis_id",payload:t.data.analysis_id}),e.push("/dashboard/"+t.data.analysis_id)})).catch((function(e){ne(!1),400===e.response.status&&(e.response.data.error.includes("Pipfile.lock")?W("Failed to parse provided Pipfile.lock"):e.response.data.error.includes("Pipfile")&&M("Failed to parse provided Pipfile"))})));case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(v.jsxs)("div",{className:t.root,children:[Object(v.jsx)(j.a,{variant:"h4",className:t.title,children:Object(v.jsx)("b",{children:"Thoth Search"})}),Object(v.jsxs)(j.a,{variant:"body1",className:t.description,children:["Thoth Search is a tool that runs analysis on a Python application. It utilizes package metadata and Thoth Adviser to analyse and recommend a software stack. ",Object(v.jsx)("br",{}),Object(v.jsx)("br",{})," You can run analysis on a specific Python package or you can provide a properly formatted Pipfile and/or Pipfile.lock to run analysis on an entire Python application."]}),Object(v.jsxs)(k.a,{value:H,exclusive:!0,onChange:function(e,t){t&&K(t)},size:"small",className:t.mode,children:[Object(v.jsx)(y.a,{value:"single","aria-label":"left aligned",disabled:!0,children:Object(v.jsx)("b",{children:"Single Package"})}),Object(v.jsx)(y.a,{value:"multiple","aria-label":"centered",children:Object(v.jsx)("b",{children:"Multiple Packages"})})]}),Object(v.jsxs)(B,{value:H,index:"single",className:"".concat(t.flexColumn," ").concat(t.stretchContent),children:[Object(v.jsxs)(m.a,{className:t.searchBar,children:[Object(v.jsx)(S,{label:"Search for a Python package",onChange:function(e){return ae(e,"single")},helperText:L,error:""!==L,type:"search",boxprops:{mr:2}}),Object(v.jsx)(O.a,{variant:"contained",color:"primary",onClick:function(){return ie()},children:Object(v.jsx)("b",{children:"Analyze"})})]}),Object(v.jsx)(x.a,{in:Q,timeout:"auto",unmountOnExit:!0,children:Object(v.jsx)(m.a,{mt:1})}),Object(v.jsx)(m.a,{textAlign:"center",mt:1,children:Object(v.jsx)(O.a,{onClick:function(){return X(!Q)},color:"primary",children:Q?"Less Options":"More Options"})})]}),Object(v.jsxs)(B,{value:H,index:"multiple",className:"".concat(t.flexColumn," ").concat(t.stretchContent),children:[Object(v.jsxs)(m.a,{className:t.multilineTextBoxContainer,children:[Object(v.jsx)(S,{label:"Pipfile contents",onChange:function(e){return ae(e,"pipfile")},helperText:T,error:""!==T,multiline:!0,rows:8,boxprops:{mr:1}}),Object(v.jsx)(S,{label:"Pipfile.lock contents",onChange:function(e){return ae(e,"lock")},helperText:q,error:""!==q,multiline:!0,rows:8,boxprops:{ml:1}})]}),Object(v.jsx)(m.a,{textAlign:"center",mt:2,children:Object(v.jsx)(g.a,{variant:"contained",color:"primary",onClick:function(){return ie()},loading:te,children:Object(v.jsx)("b",{children:"Analyze"})})})]})]})},H=n(303),K=n(304),Y=n(305),Z=Object(w.a)({root:{minWidth:275,height:"100%"},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{fontSize:14},pos:{marginBottom:12}}),Q=function(e){var t=e.cardMeta,n=e.cardBody,a=Z();return Object(v.jsxs)(H.a,{className:a.root,children:[Object(v.jsx)(K.a,{action:t.action,title:t.title,subheader:t.subTitle}),Object(v.jsx)(Y.a,{children:n})]})},X=n(306),$=n(307),ee=n(289),te=n(278),ne=["value","total","label","action"],ae=Object(X.a)((function(e){return{root:{height:10,borderRadius:5},colorPrimary:{backgroundColor:e.palette.grey["light"===e.palette.type?200:700]},bar:{borderRadius:5,backgroundColor:"#1a90ff"}}}))($.a),ie=Object(w.a)((function(e){return{root:{display:"grid",gridTemplateColumns:"repeat(6,1fr)",alignItems:"center",gridGap:e.spacing(1)},label:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},value:{textAlign:"end"}}})),re=function(e){var t=e.value,n=e.total,a=e.label,i=e.action,r=(Object(P.a)(e,ne),ie());return Object(v.jsxs)(ee.a,{container:!0,spacing:1,alignItems:"center",children:[Object(v.jsx)(ee.a,{item:!0,xs:4,children:Object(v.jsx)(te.a,{title:a,placement:"left",children:Object(v.jsx)(j.a,{variant:"body2",className:r.label,children:a})})}),Object(v.jsx)(ee.a,{item:!0,xs:1,children:Object(v.jsx)(j.a,{className:r.value,variant:"body2",children:t})}),Object(v.jsx)(ee.a,{item:!0,xs:6,children:Object(v.jsx)(ae,{variant:"determinate",value:n>0?t/n*100:0})}),Object(v.jsx)(ee.a,{item:!0,xs:!0,children:Object(v.jsx)("div",{children:null!==i&&void 0!==i?i:null})})]})},ce=n(274),oe=n(299),le=n(286),se=n(275),de=Object(w.a)((function(e){return{bar:{marginBottom:e.spacing(1)}}})),ue=function(e){var t,n,a,i,r,c,l=e.metric,s=de(),d=(null!==(t=l.all.direct)&&void 0!==t?t:0)+(null!==(n=l.all.indirect)&&void 0!==n?n:0)+(null!==(a=l.all.roots)&&void 0!==a?a:0);return Object(v.jsxs)("div",{children:[Object(v.jsx)(j.a,{variant:"body2",gutterBottom:!0,children:Object(v.jsx)("b",{children:"All Packages"})}),Object(v.jsx)(ce.a,{className:s.bar}),Object(v.jsx)(re,{value:null!==(i=l.all.roots)&&void 0!==i?i:0,total:d,label:"Root",className:s.bar}),Object(v.jsx)(re,{value:null!==(r=l.all.direct)&&void 0!==r?r:0,total:d,label:"Direct",className:s.bar}),Object(v.jsx)(re,{value:null!==(c=l.all.indirect)&&void 0!==c?c:0,total:d,label:"Indirect"}),Object(v.jsx)(j.a,{variant:"body2",gutterBottom:!0,mt:2,children:Object(v.jsx)("b",{children:"Root Packages"})}),Object(v.jsx)(ce.a,{className:s.bar}),Object(v.jsx)(oe.a,{component:"nav",children:Object.entries(l.roots).map((function(e,t){var n,a,i,r,c=Object(o.a)(e,2),d=c[0],u=(c[1],(null!==(n=l.roots[d].direct)&&void 0!==n?n:0)+(null!==(a=l.roots[d].indirect)&&void 0!==a?a:0));return Object(v.jsxs)("div",{children:[Object(v.jsx)(le.a,{children:Object(v.jsxs)(ee.a,{container:!0,alignItems:"center",children:[Object(v.jsx)(ee.a,{item:!0,xs:!0,children:Object(v.jsx)(se.a,{primary:d})}),Object(v.jsx)(ee.a,{item:!0,xs:!0,children:Object(v.jsxs)(ee.a,{container:!0,direction:"column",children:[Object(v.jsx)(ee.a,{item:!0,xs:!0,children:Object(v.jsx)(re,{value:null!==(i=l.roots[d].direct)&&void 0!==i?i:0,total:u,label:"Direct"})}),Object(v.jsx)(ee.a,{item:!0,xs:!0,children:Object(v.jsx)(re,{value:null!==(r=l.roots[d].indirect)&&void 0!==r?r:0,total:u,label:"Indirect"})})]})})]})}),Object(v.jsx)(ce.a,{variant:"middle",className:s.bar})]},d)}))})]})},je=Object(w.a)((function(e){return{bar:{marginBottom:e.spacing(1)}}})),ve=function(e){var t,n,a,i,r=e.metric,c=je(),o=(null!==(t=r.all.direct)&&void 0!==t?t:0)+(null!==(n=r.all.indirect)&&void 0!==n?n:0);return Object(v.jsxs)("div",{children:[Object(v.jsx)(re,{value:null!==(a=r.all.direct)&&void 0!==a?a:0,total:o,label:"Direct",className:c.bar}),Object(v.jsx)(re,{value:null!==(i=r.all.indirect)&&void 0!==i?i:0,total:o,label:"Indirect"})]})},be=function(e){var t=e.text;return Object(v.jsx)(j.a,{align:"center",color:"error",variant:"body1",children:t})},he=n(302),pe=Object(w.a)((function(e){return{customProgressRoot:{display:"flex",flexDirection:"column",alignItems:"center"}}})),fe=function(e){var t=e.amount,n=e.note,a=pe();return Object(v.jsxs)("div",{className:a.customProgressRoot,children:[Object(v.jsx)(he.a,{variant:t?"determinate":"indeterminate",value:null!==t&&void 0!==t?t:0}),n?Object(v.jsx)(j.a,{align:"center",variant:"body1",children:n}):null]})},me=function(e){var t=e.isError,n=e.isLoading,a=e.errorText,i=e.loadingPage,r=e.loadingAmount,c=e.loadingText,o=e.children;return Object(v.jsx)(v.Fragment,{children:t?Object(v.jsx)(be,{text:null!==a&&void 0!==a?a:"A unknown error occured"}):n?null!==i&&void 0!==i?i:Object(v.jsx)(fe,{amount:r,note:c}):o})},Oe=function(){var e,t=Object(a.useContext)(on);return Object(v.jsx)(me,{isLoading:null===(e=t.metrics)||void 0===e?void 0:e.licences,children:(null===t||void 0===t?void 0:t.focus)?Object(v.jsx)(ve,{metric:t.metrics.dependencies}):Object(v.jsx)(ue,{metric:t.metrics.dependencies})})},xe=n(290),ge=n(124),ye=n.n(ge),ke=n(125),we=n.n(ke),Ce=Object(w.a)((function(e){return{bar:{marginBottom:e.spacing(1)},marginBottom:{marginBottom:e.spacing(2)},chip:{margin:e.spacing(.5)},border:{marginTop:e.spacing(1),marginBottom:e.spacing(1)}}})),Ne=function(e){var t,n=e.name,a=e.value,r=e.totalLicenses,c=Ce(),l=i.a.useState(!1),s=Object(o.a)(l,2),d=s[0],u=s[1];return Object(v.jsxs)("div",{children:[Object(v.jsx)("div",{className:c.flex,onClick:function(){return u(!d)},children:Object(v.jsx)(re,{value:null!==(t=Object.keys(a).length-3)&&void 0!==t?t:0,total:r,label:n,className:c.bar,action:d?Object(v.jsx)(ye.a,{}):Object(v.jsx)(we.a,{})},n)}),Object(v.jsxs)(x.a,{in:d,timeout:"auto",unmountOnExit:!0,children:[Object(v.jsx)("div",{className:c.border,children:Object.entries(a).sort((function(e,t){return e[1]-t[1]})).map((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1];return"_"===n[0]?null:Object(v.jsx)(xe.a,{className:c.chip,color:0===a?"primary":1===a?"secondary":"default",label:n,onClick:null},n)}))}),Object(v.jsx)(ce.a,{})]})]})},Ee=function(e){var t,n,a=e.metric,r=e.deepError,c=Ce(),l=i.a.useState(!1),s=Object(o.a)(l,2),d=s[0],u=s[1],b=Object.entries(null!==(t=null===a||void 0===a?void 0:a.all)&&void 0!==t?t:{}).sort((function(e,t){return Object.keys(t[1]).length-Object.keys(e[1]).length})),h=Object.entries(null!==(n=null===a||void 0===a?void 0:a.all)&&void 0!==n?n:{}).reduce((function(e,t){return e+Object.keys(t[1]).length}),0);return Object(v.jsxs)("div",{className:c.root,children:[Object(v.jsx)(j.a,{variant:"body2",gutterBottom:!0,children:Object(v.jsx)("b",{children:"Dependency Licenses"})}),Object(v.jsx)(ce.a,{}),Object(v.jsxs)(me,{state:r?"error":a.all,errorText:"Could not run analysis on dependencies.",children:[b.slice(0,10).map((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1];return Object(v.jsx)(Ne,{name:n,value:a,totalLicenses:h},n)})),Object(v.jsx)(x.a,{in:d,timeout:"auto",unmountOnExit:!0,children:b.slice(10).map((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1];return Object(v.jsx)(Ne,{name:n,value:a,totalLicenses:h},n)}))}),Object(v.jsx)(m.a,{textAlign:"center",children:Object(v.jsx)(O.a,{onClick:function(){return u(!d)},color:"primary",children:d?"Less":"More"})})]})]})},Se=Object(w.a)((function(e){return{bar:{marginBottom:e.spacing(1)},marginBottom:{marginBottom:e.spacing(2)}}})),Pe=function(e){var t,n=e.metric,a=Se();return Object(v.jsxs)("div",{className:a.root,children:[Object(v.jsx)(j.a,{variant:"body2",gutterBottom:!0,children:Object(v.jsx)("b",{children:"License"})}),Object(v.jsx)(ce.a,{}),Object(v.jsx)(j.a,{className:a.marginBottom,variant:"h6",children:n.root}),Object(v.jsx)(j.a,{variant:"body2",gutterBottom:!0,children:Object(v.jsx)("b",{children:"Dependency Licenses"})}),Object(v.jsx)(ce.a,{}),Object.entries(null!==(t=null===n||void 0===n?void 0:n.all)&&void 0!==t?t:{}).map((function(e){var t,i=Object(o.a)(e,2),r=i[0],c=i[1];return Object(v.jsx)(re,{value:null!==(t=Object.keys(c).length)&&void 0!==t?t:0,total:n.total,label:r,className:a.bar},r)}))]})},_e=function(){var e,t=Object(a.useContext)(on);return Object(v.jsx)(me,{isLoading:null===(e=t.metrics)||void 0===e?void 0:e.licences,children:(null===t||void 0===t?void 0:t.focus)?Object(v.jsx)(Pe,{metric:t.metrics.licenses}):Object(v.jsx)(Ee,{metric:t.metrics.licenses})})},Be=Object(w.a)((function(e){return{bar:{marginBottom:e.spacing(1)},header:{marginTop:e.spacing(3)},flex:{display:"flex",flexDirection:"column"}}})),Le=function(e){var t,n,a,i=e.metric,r=Be(),c=i.added+i.removed+i.version+i.equal;return Object(v.jsxs)("div",{children:[Object(v.jsx)(j.a,{variant:"body2",gutterBottom:!0,children:i.build}),Object(v.jsx)(j.a,{variant:"body2",gutterBottom:!0,mt:2,children:Object(v.jsx)("b",{children:"Differences between the old Pipfile.lock and Thoth's new Pipfile.lock"})}),Object(v.jsx)(ce.a,{className:r.bar}),Object(v.jsx)(re,{value:null!==(t=i.added)&&void 0!==t?t:0,total:c,label:"Added Packages",className:r.bar}),Object(v.jsx)(re,{value:null!==(n=i.removed)&&void 0!==n?n:0,total:c,label:"Removed Packages",className:r.bar}),Object(v.jsx)(re,{value:null!==(a=i.version)&&void 0!==a?a:0,total:c,label:"Changed Version"}),Object(v.jsx)(j.a,{variant:"body2",className:r.header,gutterBottom:!0,mt:2,children:Object(v.jsx)("b",{children:"Noteworthy Justifications"})}),Object(v.jsx)(ce.a,{className:r.bar}),Object.entries(i.justification).map((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1];return Object(v.jsxs)(j.a,{variant:"body2",gutterBottom:!0,children:[n,": ",a]},n)}))]})},Ae=function(){var e,t=Object(a.useContext)(on);return Object(v.jsx)(me,{isLoading:!(null===(e=t.metrics)||void 0===e?void 0:e.advise),children:(null===t||void 0===t?void 0:t.focus)?null:Object(v.jsx)(Le,{metric:t.metrics.advise})})},Re=function(){var e=Object(a.useContext)(on);return Object(v.jsx)(me,{isLoading:void 0===(null===e||void 0===e?void 0:e.metrics),children:Object(v.jsx)(ee.a,{container:!0,spacing:3,children:(null===e||void 0===e?void 0:e.metrics)?Object.keys(e.metrics).map((function(e){return Object(v.jsx)(ee.a,{item:!0,xs:12,sm:6,children:Object(v.jsx)(Q,{cardMeta:{title:e.charAt(0).toUpperCase()+e.slice(1)},cardBody:"dependencies"===e?Object(v.jsx)(Oe,{}):"licenses"===e?Object(v.jsx)(_e,{}):"advise"===e?Object(v.jsx)(Ae,{}):null})},e)})):null})})},Ie=n(126),Te=n.n(Ie),Me=n(127),De=n.n(Me),Ge=["text","icon","link"],qe=Object(w.a)((function(e){return{root:{display:"flex",alignItems:"center"}}})),ze=function(e){var t=e.text,n=e.icon,a=e.link,i=Object(P.a)(e,Ge),r=qe();return Object(v.jsxs)("div",{className:"".concat(r.root," ").concat(i.className),children:[n,Object(v.jsx)(j.a,{href:a||null,variant:"body2",marginLeft:!0,children:t})]})};function We(e){var t=Math.floor((new Date-e)/1e3),n=t/31536e3;if(n>1){var a=Math.floor(n);return a+" year"+(1!==a?"s":"")}if((n=t/2592e3)>1){var i=Math.floor(n);return i+" month"+(1!==i?"s":"")}if((n=t/86400)>1){var r=Math.floor(n);return r+" day"+(1!==r?"s":"")}if((n=t/3600)>1){var c=Math.floor(n);return c+" hour"+(1!==c?"s":"")}if((n=t/60)>1){var o=Math.floor(n);return o+" minute"+(1!==o?"s":"")}var l=Math.floor(t);return l+" second"+(1!==l?"s":"")}var Fe=Object(w.a)((function(e){return{titleRow:{display:"flex",alignItems:"center",marginBottom:e.spacing(1)},marginLeft:{marginLeft:e.spacing(2)},marginRight:{marginRight:e.spacing(2)},linksRow:{display:"flex",marginBottom:e.spacing(3)},warning:{display:"flex"}}})),Je=function(){var e,t,n,i,r,c,o,l,s,d,u,b,h,p,f,m,O,x,g=Fe(),y=Object(a.useContext)(on),k=y.roots,w=y.packageWarning;return Object(v.jsxs)("div",{children:[Object(v.jsxs)("div",{className:g.titleRow,children:[Object(v.jsx)(j.a,{variant:"h4",children:Object(v.jsx)("b",{children:null===(e=k[0])||void 0===e||null===(t=e.metadata)||void 0===t?void 0:t.name})}),Object(v.jsxs)(j.a,{className:g.marginLeft,variant:"subtitle1",children:["v",null!==(n=null===(i=k[0])||void 0===i||null===(r=i.metadata)||void 0===r?void 0:r.version)&&void 0!==n?n:"NaN"]})]}),Object(v.jsx)(j.a,{gutterBottom:!0,variant:"body1",children:null!==(c=null===(o=k[0])||void 0===o||null===(l=o.metadata)||void 0===l?void 0:l.summary)&&void 0!==c?c:"NaN"}),Object(v.jsxs)("div",{className:g.linksRow,children:[Object(v.jsx)(ze,{text:null!==(s=null===(d=k[0])||void 0===d||null===(u=d.metadata)||void 0===u?void 0:u.license)&&void 0!==s?s:"NaN",icon:Object(v.jsx)(Te.a,{})}),Object(v.jsx)(ze,{className:g.marginLeft,text:"Latest version published "+We(new Date(null===(b=k[0])||void 0===b||null===(h=b.metadata)||void 0===h||null===(p=h.releases)||void 0===p||null===(f=p[null===(O=k[0])||void 0===O||null===(x=O.metadata)||void 0===x?void 0:x.version])||void 0===f||null===(m=f[0])||void 0===m?void 0:m.upload_time))+" ago.",icon:Object(v.jsx)(De.a,{})})]}),w&&0!==w.length?w.map((function(e){return Object(v.jsxs)(j.a,{gutterBottom:!0,color:"error",className:g.marginRight,variant:"body2",children:["Dependency ",Object(v.jsx)("i",{children:w[0].value.label})," ",Object(v.jsx)("i",{children:w[0].value.metadata.version})," is currently not supported by Thoth."]})})):null]})},Ve=n(284),Ue=n(128),He=n.n(Ue),Ke=["info"],Ye=Object(w.a)((function(e){return{titleRow:{display:"flex",alignItems:"center",marginBottom:e.spacing(1)},marginLeft:{marginLeft:e.spacing(2)},marginRight:{marginRight:e.spacing(2)},linksRow:{display:"flex",marginBottom:e.spacing(3),alignItems:"center"},alert:{width:"100%",marginTop:e.spacing(1)}}})),Ze=function(e){var t=e.info,n=Object(P.a)(e,Ke);return Object(v.jsx)(Ve.a,{className:n.className,action:Object(v.jsx)(O.a,{color:"inherit",size:"small",href:t.link,children:"DETAILS"}),severity:t.type.toLowerCase(),children:t.message})},Qe=function(e){var t,n,r=e.adviseID,c=Ye(),l=Object(a.useContext)(on),s=i.a.useState(!1),d=Object(o.a)(s,2),u=d[0],b=d[1],h=function(){var e,t,n;return(null===l||void 0===l||null===(e=l.advise)||void 0===e?void 0:e.report)?l.advise.report.ERROR?["ERROR","error"]:["COMPLETE","success"]:(null===l||void 0===l||null===(t=l.advise)||void 0===t||null===(n=t.status)||void 0===n?void 0:n.state)?[l.advise.status.state.toUpperCase(),"info"]:["UNKNOWN",void 0]}(),p=Object(o.a)(h,2),f=p[0],m=p[1],g=(null===l||void 0===l||null===(t=l.advise)||void 0===t||null===(n=t.report)||void 0===n?void 0:n.stack_info)?l.advise.report.stack_info.filter((function(e){return"ERROR"===e.type})):null;return Object(v.jsxs)("div",{children:[Object(v.jsx)(j.a,{variant:"h4",children:Object(v.jsx)("b",{children:r})}),Object(v.jsxs)("div",{className:c.linksRow,children:[Object(v.jsx)(xe.a,{label:f,color:m}),Object(v.jsx)(ze,{className:c.marginLeft,text:function(){var e,t,n,a,i,r;return(null===l||void 0===l||null===(e=l.advise)||void 0===e||null===(t=e.status)||void 0===t?void 0:t.finished_at)?"Advise finished "+We(new Date(l.advise.status.finished_at))+" ago.":(null===l||void 0===l||null===(n=l.advise)||void 0===n||null===(a=n.status)||void 0===a?void 0:a.started_at)?"Advise started "+We(new Date(l.advise.status.started_at))+" ago.":(null===l||void 0===l||null===(i=l.advise)||void 0===i||null===(r=i.metadata)||void 0===r?void 0:r.datetime)?"Advise finished "+We(new Date(l.advise.metadata.datetime+"Z"))+" ago.":"Time started/finished not available"}(),icon:Object(v.jsx)(He.a,{})})]}),(null===g||void 0===g?void 0:g.length)>0?Object(v.jsxs)("div",{children:[Object(v.jsx)(Ze,{info:g[0]}),Object(v.jsx)(x.a,{in:u,timeout:"auto",unmountOnExit:!0,children:null===g||void 0===g?void 0:g.slice(1).map((function(e){return Object(v.jsx)(Ze,{info:e,className:c.alert})}))}),Object(v.jsx)(O.a,{color:"inherit",size:"small",onClick:function(){return b(!u)},children:(null===g||void 0===g?void 0:g.length)>1?u?"LESS":"MORE":null})]}):null]})},Xe=n(14);function $e(e,t,n){var a=n.filter((function(t){return e.includes(t.from)})),i={nodes:[],edges:[]};return a.forEach((function(e){var a=et(e,{nodes:[],edges:[]},n,t);i={nodes:Object(Xe.a)(new Set([].concat(Object(Xe.a)(a.nodes),Object(Xe.a)(i.nodes)))),edges:Object(Xe.a)(new Set([].concat(Object(Xe.a)(a.edges),Object(Xe.a)(i.edges))))}})),i}function et(e,t,n,a){if(t.edges.includes(e.id))return t;if(t.nodes.push(e.from,e.to),t.edges.push(e.id),e.to===a)return t;var i={nodes:[],edges:[]};return n.filter((function(t){return t.from===e.to})).forEach((function(e){var r=et(e,t,n,a);i={nodes:Object(Xe.a)(new Set([].concat(Object(Xe.a)(r.nodes),Object(Xe.a)(i.nodes)))),edges:Object(Xe.a)(new Set([].concat(Object(Xe.a)(r.edges),Object(Xe.a)(i.edges))))}})),i}var tt={manipulation:{enabled:!1,editNode:function(e,t){e.fixed=!e.fixed.x,t(e)}},interaction:{hover:!0,hoverConnectedEdges:!1,selectConnectedEdges:!1,selectable:!1},edges:{chosen:!1,smooth:!1,color:{color:"#5c6470"},arrowStrikethrough:!1,arrows:{from:{enabled:!0,type:"triangle"}}},nodes:{chosen:!1,color:{background:"#5c6470",border:"#fff",hover:{background:"#f39200",border:"#fff"}},shape:"dot",size:10,borderWidth:2,labelHighlightBold:!1,font:{color:"#393e46",strokeWidth:2,size:15}},physics:{hierarchicalRepulsion:{damping:.1,springLength:200},solver:"hierarchicalRepulsion",minVelocity:.15}},nt=n(58),at=["data","filterdGraph","searchText","root","selectedPackage","search"],it=Object(w.a)((function(e){return{root:{display:"flex",flexFlow:"column nowrap"},canvas:{flex:"1 1 auto",height:"75vh"}}})),rt=function(e){var t=e.data,n=e.filterdGraph,i=(e.searchText,e.root),r=e.selectedPackage,c=e.search,l=Object(P.a)(e,at),s=it(),d=Object(a.useState)(t),u=Object(o.a)(d,2),j=u[0],b=u[1],h=Object(a.useRef)(null);return Object(a.useEffect)((function(){var e=h.current&&new nt.b(h.current,j,tt),n=t.nodes.get(i);n.color="#4fc1ea",n.font={color:"#4fc1ea",strokeWidth:3,size:20},t.nodes.updateOnly(n);var a=document.getElementById("mynetwork").getElementsByTagName("canvas")[0];function r(e){a.style.cursor=e}e.on("hoverNode",(function(){r("grab")})),e.on("blurNode",(function(){r("default")})),e.on("dragStart",(function(){r("grabbing")})),e.on("dragging",(function(){r("grabbing")})),e.on("dragEnd",(function(){r("grab")})),e.on("dragEnd",(function(t){0!==t.nodes.length&&e.editNode(t.nodes[0])})),e.on("dragStart",(function(t){0!==t.nodes.length&&void 0!==e.body.nodes[t.nodes[0]].options.x&&e.body.nodes[t.nodes[0]].options.x&&e.editNode(t.nodes[0])}))}),[i,j,t.nodes]),Object(a.useEffect)((function(){var e="#f39200";if(t.nodes.updateOnly(t.nodes.get().map((function(t){return t.color===e&&(t.color=n.find((function(e){return e.id===t.id})).color),t}))),null!==r){var a=t.nodes.get(r),c=$e([r],i,t.edges.map((function(e){return e})));b({nodes:new nt.a(t.nodes.get(c.nodes)),edges:new nt.a(t.edges.get(c.esges))}),a.id!==i&&(a.color=e),t.nodes.updateOnly(a)}else b(t)}),[r,i,t,n]),Object(a.useEffect)((function(){if(t.nodes.updateOnly(t.nodes.get().map((function(e){return e.id!==i&&(e.opacity=1,e.font={size:tt.nodes.font.size}),e}))),t.edges.updateOnly(t.edges.get().map((function(e){return e.color={opacity:1},e}))),""!==c){var e=t.nodes.get({filter:function(e){return e.label.includes(c)}}),n=$e(e.map((function(e){return e.id})),i,t.edges.map((function(e){return e}))),a=t.edges.get().filter((function(e){return!n.edges.includes(e.id)})).map((function(e){return e.color={opacity:.05},e})),r=t.nodes.get().filter((function(e){return!n.nodes.includes(e.id)})).map((function(e){return e.id!==i&&(e.font={size:0},e.opacity=.05),e}));e=e.map((function(e){return e.id,e})),t.nodes.updateOnly(r.concat(e)),t.edges.updateOnly(a)}}),[c,t,i]),Object(v.jsx)("div",{className:"".concat(s.root," ").concat(l.className),children:Object(v.jsx)("div",{ref:h,id:"mynetwork",className:s.canvas})})},ct=n(313),ot=n(314),lt=n(311),st=n(312),dt=n(309),ut=n(282),jt=n(310),vt=n(291),bt=n(298),ht=n(276),pt=n(130),ft=n.n(pt),mt=n(129),Ot=n.n(mt),xt=n(131),gt=n.n(xt);function yt(e,t,n){return t[n]<e[n]?-1:t[n]>e[n]?1:0}function kt(e,t){return"desc"===e?function(e,n){return yt(e,n,t)}:function(e,n){return-yt(e,n,t)}}function wt(e,t){var n=e.map((function(e,t){return[e,t]}));return n.sort((function(e,n){var a=t(e[0],n[0]);return 0!==a?a:e[1]-n[1]})),n.map((function(e){return e[0]}))}var Ct=[{id:"name",numeric:!1,label:"Package"},{id:"depth",numeric:!0,label:"Depth"},{id:"license",numeric:!1,label:"License"},{id:"dependencies",numeric:!0,label:"Direct Dependencies"}];function Nt(e){var t=e.order,n=e.orderBy,a=e.onRequestSort;return Object(v.jsx)(dt.a,{children:Object(v.jsx)(jt.a,{children:Ct.map((function(e){return Object(v.jsx)(lt.a,{align:e.numeric?"right":"left",padding:"normal",sortDirection:n===e.id&&t,children:Object(v.jsxs)(vt.a,{active:n===e.id,direction:n===e.id?t:"asc",onClick:(i=e.id,function(e){a(e,i)}),children:[e.label,n===e.id?Object(v.jsx)(m.a,{component:"span",sx:ht.a,children:"desc"===t?"sorted descending":"sorted ascending"}):null]})},e.id);var i}))})})}function Et(e){var t=e.filterdGraph,n=e.search,r=(e.selectedPackage,Object(a.useState)("asc")),c=Object(o.a)(r,2),l=c[0],s=c[1],d=i.a.useState("calories"),u=Object(o.a)(d,2),b=u[0],h=u[1],p=i.a.useState([]),f=Object(o.a)(p,2),O=f[0],g=f[1],y=i.a.useState(0),k=Object(o.a)(y,2),w=k[0],C=k[1],N=i.a.useState(5),E=Object(o.a)(N,2),S=E[0],P=E[1],_=i.a.useState([]),B=Object(o.a)(_,2),L=B[0],A=B[1],R=i.a.useState(null),I=Object(o.a)(R,2),T=I[0],M=I[1];Object(a.useEffect)((function(){if(t){var e=[];t.forEach((function(t){var n,a,i,r,c,o;-1!==t.depth&&e.push({name:t.label,warnings:[],depth:t.node.value.depth,license:null===t||void 0===t||null===(n=t.node)||void 0===n||null===(a=n.value)||void 0===a||null===(i=a.metadata)||void 0===i?void 0:i.license,dependencies:t.node.adjacents.size,change:t.change,summary:null===t||void 0===t||null===(r=t.node)||void 0===r||null===(c=r.value)||void 0===c||null===(o=c.metadata)||void 0===o?void 0:o.summary})})),A(e)}}),[t]);var D=w>0?Math.max(0,(1+w)*S-L.length):0;return Object(v.jsx)(m.a,{sx:{width:"100%"},children:Object(v.jsxs)(bt.a,{sx:{width:"100%",mb:2},children:[Object(v.jsx)(st.a,{children:Object(v.jsxs)(ct.a,{sx:{minWidth:750},size:"medium",children:[Object(v.jsx)(Nt,{numSelected:O.length,order:l,orderBy:b,onRequestSort:function(e,t){s(b===t&&"asc"===l?"desc":"asc"),h(t)},rowCount:L.length}),Object(v.jsxs)(ot.a,{children:[wt(L,kt(l,b)).filter((function(e){return e.name.includes(n)})).slice(w*S,w*S+S).map((function(e,t){var n,a="enhanced-table-checkbox-".concat(t),r="removed"===e.change?"error":"added"===e.change?"success":void 0;return Object(v.jsxs)(i.a.Fragment,{children:[Object(v.jsxs)(jt.a,{hover:!0,onClick:function(){g(e.name),T!==e.name?M(e.name):M(null)},tabIndex:-1,selected:O===e.name,children:[Object(v.jsx)(lt.a,{component:"th",id:a,scope:"row",children:Object(v.jsxs)(m.a,{display:"flex",children:["removed"===e.change?Object(v.jsx)(Ot.a,{color:r}):"added"===e.change?Object(v.jsx)(ft.a,{color:r}):Object(v.jsx)(gt.a,{}),Object(v.jsx)(j.a,{ml:2,children:e.name})]})}),Object(v.jsx)(lt.a,{align:"right",children:e.depth}),Object(v.jsx)(lt.a,{align:"right",children:e.license}),Object(v.jsx)(lt.a,{align:"right",children:e.dependencies})]},e.name),Object(v.jsx)(jt.a,{children:Object(v.jsx)(lt.a,{style:{paddingBottom:0,paddingTop:0},colSpan:6,children:Object(v.jsx)(x.a,{in:T===e.name,timeout:"auto",unmountOnExit:!0,children:Object(v.jsx)(j.a,{gutterBottom:!0,variant:"body1",children:null!==(n=e.summary)&&void 0!==n?n:"NaN"})})})})]})})),D>0&&Object(v.jsx)(jt.a,{style:{height:53*D},children:Object(v.jsx)(lt.a,{colSpan:6})})]})]})}),Object(v.jsx)(ut.a,{rowsPerPageOptions:[5,10,25],component:"div",count:L.length,rowsPerPage:S,page:w,onPageChange:function(e,t){C(t)},onRowsPerPageChange:function(e){P(parseInt(e.target.value,10)),C(0)}})]})})}var St=n(3),Pt=n(132),_t=n(69),Bt=n(70),Lt=function(){function e(t,n){Object(_t.a)(this,e),this.adjacents=new Set,this.key=t,this.value=n}return Object(Bt.a)(e,[{key:"addAdjacent",value:function(e){this.adjacents.add(e)}},{key:"isAdjacent",value:function(e){return this.adjacents.has(e)}},{key:"getAdjacents",value:function(){return Array.from(this.adjacents)}}]),e}(),At=function(){function e(){Object(_t.a)(this,e),this.nodes=new Map}return Object(Bt.a)(e,[{key:"addVertex",value:function(e,t){if(this.nodes.has(e))return this.nodes.get(e);var n=new Lt(e,t);return this.nodes.set(e,n),n}},{key:"addEdge",value:function(e,t){var n=this.nodes.get(e),a=this.nodes.get(t);return n.addAdjacent(a),[n,a]}},{key:"areAdjacents",value:function(e,t){var n=this.nodes.get(e),a=this.nodes.get(t);return!(!n||!a)&&n.isAdjacent(a)}},{key:"graphSearch",value:p.a.mark((function e(t){var n,a,i,r,c=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=c.length>1&&void 0!==c[1]?c[1]:"bfs",a=new Map,(i=[]).push(t);case 4:if(0===i.length){e.next=13;break}if(!(r="dfs"===n?i.pop():i.shift())||a.has(r)){e.next=11;break}return e.next=9,r;case 9:a.set(r),r.getAdjacents().forEach((function(e){return i.push(e)}));case 11:e.next=4;break;case 13:case"end":return e.stop()}}),e)}))},{key:"findPath",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,a=this.nodes.get(e),i=this.nodes.get(t),r=new Map(n);if(!i||!a)return[];if(r.set(a),e===t)return Array.from(r.keys());var c,o=Object(Pt.a)(a.getAdjacents());try{for(o.s();!(c=o.n()).done;){var l=c.value;if(!r.has(l)){var s=this.findPath(l.value,t,r);if(s.length)return s}}}catch(d){o.e(d)}finally{o.f()}return[]}},{key:"findAllPaths",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,i=this.nodes.get(e),r=this.nodes.get(t),c=new Map(a);if(!r||!i)return[];if(c.set(i),e===t)return[Array.from(c.keys())];var o=[];return i.getAdjacents().forEach((function(e){c.has(e)||n.findAllPaths(e.value,t,c).forEach((function(e){return o.push(e)}))})),o}}]),e}(),Rt=n(20);function It(e,t,n){var i=Object(a.useContext)(ln);Object(a.useEffect)((function(){if(e&&t&&n){var a=new At;Object(f.a)(p.a.mark((function n(){var r,c,l,s,d;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=[],n.next=3,Promise.all(Object.entries(t).map(function(){var e=Object(f.a)(p.a.mark((function e(n){var i,c,l,s,d,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Object(o.a)(n,2),c=i[0],l=i[1],!localStorage.getItem(c+l.version.replace("==",""))){e.next=8;break}d=JSON.parse(localStorage.getItem(c+l.version.replace("==",""))),u={id:d.name.toLowerCase().replace(".","-"),label:d.name,depth:null,metadata:d},a.addVertex(u.id,u),null===(s=d.requires_dist)||void 0===s||s.forEach((function(e){var n=e.split(" ",1)[0].toLowerCase().replace(".","-");t[n]&&r.push(n)})),e.next=11;break;case 8:return e.next=10,q(c,l.version.replace("==","")).then((function(e){var n,i={id:e.name.toLowerCase().replace(".","-"),label:e.name,depth:null,metadata:e};localStorage.setItem(c+l.version.replace("==",""),JSON.stringify(e)),a.addVertex(i.id,i),null===(n=e.requires_dist)||void 0===n||n.forEach((function(e){var n=e.split(" ",1)[0].toLowerCase().replace(".","-");t[n]&&r.push(n)}))}));case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).catch((function(e){var t,n;i({type:"error",payload:(null!==(t=null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.statusText)&&void 0!==t?t:"Unknown Error")+": an error occured while fetching package data."})}));case 3:return c=a.addVertex("*App",{id:"*App",label:"App",depth:-1}),r.push("*App"),l=new Map,s=[],a.nodes.forEach((function(t,n,i){if(!r.includes(n)||Object.keys(e).includes(n)){var o=i.get(n);o.value.depth=0,s.push(o),a.addEdge(c.key,o.key)}})),d=function(e,t,n){return function e(a){return t(a)?n().then(e):Promise.resolve(a)}(e)},n.next=11,d(s,(function(e){return e.length>0}),(function(){var e,t,n=s.pop();n&&!l.has(n)&&(l.set(n),(null===n||void 0===n||null===(e=n.value)||void 0===e||null===(t=e.metadata)||void 0===t?void 0:t.requires_dist)&&n.value.metadata.requires_dist.map(function(){var e=Object(f.a)(p.a.mark((function e(t){var i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=a.nodes.get(t.split(" ",1)[0].toLowerCase().replace(".","-")))){e.next=6;break}return i.value.depth=n.value.depth+1,a.addEdge(n.key,i.value.id),e.next=6,s.push(i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));return new Promise((function(e,t){e(s)}))}));case 11:case"end":return n.stop()}}),n)})))().then((function(){i({type:"graph",name:n,payload:a})}))}}),[e,t,i,n])}var Tt=n(204),Mt=n(205),Dt=n(285),Gt=n(315),qt=n(292),zt=n(316),Wt=n(317),Ft=n(136),Jt=n.n(Ft),Vt=n(133),Ut=n.n(Vt),Ht=n(134),Kt=n.n(Ht),Yt=n(135),Zt=n.n(Yt),Qt=Object(w.a)((function(e){return{graph:{padding:e.spacing(2)},buttonGroup:{marginTop:e.spacing(2),marginLeft:e.spacing(2)},lockfile:{overflow:"scroll",paddingLeft:e.spacing(1)}}})),Xt=function(){var e,t,n,r,c,l,s,d,u,b,h,p,f,x,g,y,k,w,C=Qt(),N=Object(a.useContext)(on),E=null!==(e=N.focus)&&void 0!==e?e:"*App",P=Object(a.useState)(null),_=Object(o.a)(P,2),L=_[0],A=_[1],R=Object(a.useState)(!1),I=Object(o.a)(R,2),T=I[0],M=I[1],D=Object(a.useState)(""),G=Object(o.a)(D,2),q=G[0],z=G[1],W=Object(a.useState)(!1),F=Object(o.a)(W,2),J=F[0],V=F[1],U=Object(a.useState)(0),H=Object(o.a)(U,2),K=H[0],Y=H[1],Z=i.a.useState("graph"),Q=Object(o.a)(Z,2),X=Q[0],$=Q[1],te=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=Object(a.useContext)(ln),c=Object(a.useContext)(on),l=Object(Rt.a)(),s=Object(a.useState)(void 0),d=Object(o.a)(s,2),u=d[0],j=d[1],v=Object(a.useState)(void 0),b=Object(o.a)(v,2),h=b[0],p=b[1];return Object(a.useEffect)((function(){if(e&&t&&n){var a={nodes:[],edges:[]},i=new Map;e.nodes.forEach((function(r,c){if(t.nodes.has(c)){var o,s,d,u=t.nodes.get(c);c===n||r.value.metadata.version===u.value.metadata.version?a.nodes.push({id:u.value.id,label:u.value.label+" "+(null!==(o=null===u||void 0===u||null===(s=u.value)||void 0===s||null===(d=s.metadata)||void 0===d?void 0:d.version)&&void 0!==o?o:""),node:u,change:"equal"}):a.nodes.push({id:u.value.id,label:u.value.label+" "+u.value.metadata.version,font:{color:l.palette.success.main},node:u,change:"version"})}else a.nodes.push({id:r.value.id,label:r.value.label+" "+r.value.metadata.version,font:{color:l.palette.error.main},color:l.palette.error.main,node:e.nodes.get(r.value.id),change:"removed"}),i.set(r.value.id,l.palette.error.main)})),t.nodes.forEach((function(n,r){e.nodes.has(r)||(a.nodes.push({id:n.value.id,label:n.value.label+" "+n.value.metadata.version,font:{color:l.palette.success.main},color:l.palette.success.main,node:t.nodes.get(n.value.id),change:"added"}),i.set(n.value.id,l.palette.success.main))})),e.nodes.forEach((function(e,t){e.adjacents.forEach((function(t){var n;a.edges.push({to:e.value.id,from:t.value.id,color:null!==(n=i.get(t.value.id))&&void 0!==n?n:void 0})}))})),t.nodes.forEach((function(e,t){e.adjacents.forEach((function(t){var n;a.edges.push({to:e.value.id,from:t.value.id,color:null!==(n=i.get(t.value.id))&&void 0!==n?n:void 0})}))}));var c={nodes:new nt.a(a.nodes),edges:new nt.a(a.edges)};j(c),r({type:"graph",name:"mergedGraph",payload:a.nodes})}}),[e,t,l,n,r]),Object(a.useEffect)((function(){if(c.mergedGraph&&(null===u||void 0===u?void 0:u.edges)){var e=c.mergedGraph.filter((function(e){return"removed"!==e.change||i}));p(e),j({nodes:new nt.a(e),edges:u.edges})}}),[i,r,c.mergedGraph,null===u||void 0===u?void 0:u.edges]),{visGraph:u,filterdGraph:h}}(N.initGraph,N.adviseGraph,E,J),ne=te.visGraph,ae=te.filterdGraph,ie=function(e,t){return function(n,a){if(M(!!a&&t),a){A(e);var i=document.getElementById(e);i&&i.scrollIntoView({block:"start",behavior:"smooth"})}else A(null)}};return Object(v.jsx)(me,{isLoading:void 0===ne,children:Object(v.jsxs)(ee.a,{container:!0,spacing:2,justifyContent:"center",alignItems:"flex-start",children:[Object(v.jsx)(ee.a,{item:!0,s:12,md:6,mt:2,children:Object(v.jsxs)(bt.a,{children:[Object(v.jsxs)(ee.a,{container:!0,spacing:1,alignItems:"center",ml:1,children:[Object(v.jsx)(ee.a,{item:!0,md:4,children:Object(v.jsxs)(Tt.a,{value:X,exclusive:!0,onChange:function(e,t){t&&$(t)},children:[Object(v.jsx)(Mt.a,{value:"graph",children:Object(v.jsx)(Ut.a,{})}),Object(v.jsx)(Mt.a,{value:"table",children:Object(v.jsx)(Kt.a,{})}),Object(v.jsx)(Mt.a,{value:"file",children:Object(v.jsx)(Zt.a,{})})]})}),"file"!==X?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(ee.a,{item:!0,md:4,children:Object(v.jsx)(S,{label:"Filter packages",onChange:function(e){return z(e.target.value)}})}),Object(v.jsx)(ee.a,{item:!0,md:4,children:Object(v.jsx)(Mt.a,{size:"small",value:"check",selected:J,onChange:function(){V(!J)},children:"Include Changes"})})," "]}):null]}),Object(v.jsx)(B,{value:X,index:"graph",children:Object(v.jsx)(rt,{data:ne,filterdGraph:ae,className:C.graph,root:E,selectedPackage:L,search:q})}),Object(v.jsx)(B,{value:X,index:"table",children:Object(v.jsx)(Et,{filterdGraph:ae,search:null!==L&&void 0!==L?L:q})}),Object(v.jsx)(B,{value:X,index:"file",children:Object(v.jsx)(j.a,{variant:"caption",children:Object(v.jsx)("pre",{children:Object(v.jsx)("div",{className:C.lockfile,dangerouslySetInnerHTML:{__html:null===(t=JSON.stringify(null===N||void 0===N||null===(n=N.advise)||void 0===n||null===(r=n.report)||void 0===r||null===(c=r.products)||void 0===c||null===(l=c[0])||void 0===l||null===(s=l.project)||void 0===s?void 0:s.requirements_locked,void 0,4))||void 0===t?void 0:t.replaceAll(new RegExp('("'+(null===(d=Object.keys(null===N||void 0===N||null===(u=N.advise)||void 0===u||null===(b=u.report)||void 0===b||null===(h=b.products)||void 0===h||null===(p=h[0])||void 0===p||null===(f=p.project)||void 0===f||null===(x=f.requirements_locked)||void 0===x?void 0:x.default))||void 0===d?void 0:d.join('"|"'))+'")',"g"),(function(e){return'<a id="'.concat(e.slice(1,-1),'">').concat(e,"</a>")}))}})})})})]})}),Object(v.jsxs)(ee.a,{item:!0,s:12,md:6,children:[Object(v.jsxs)(Dt.a,{value:K,onChange:function(e,t){return Y(t)},indicatorColor:"primary",textColor:"primary",children:[Object(v.jsx)(Gt.a,{label:"Advise"}),Object(v.jsx)(Gt.a,{label:"Licenses"})]}),Object(v.jsx)(m.a,{mt:4,children:Object(v.jsx)(B,{value:K,index:0,children:null===N||void 0===N||null===(g=N.advise)||void 0===g||null===(y=g.report)||void 0===y||null===(k=y.products)||void 0===k||null===(w=k[0])||void 0===w?void 0:w.justification.map((function(e,t){return"INFO"!==e.type?Object(v.jsxs)(qt.a,{onChange:ie(e.package_name,t),expanded:T===t,children:[Object(v.jsx)(zt.a,{expandIcon:Object(v.jsx)(Jt.a,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:Object(v.jsx)(j.a,{children:e.message})}),Object(v.jsxs)(Wt.a,{children:[Object(v.jsx)(j.a,{children:e.advisory}),Object(v.jsx)(O.a,{href:e.link,children:"READ MORE"})]})]},t):null}))})}),Object(v.jsx)(B,{value:K,index:1,children:"under construnction"})]})]})})},$t=Object(w.a)((function(e){return{root:{flexGrow:1,maxWidth:"95%",marginLeft:"auto",marginRight:"auto",paddingRight:e.spacing(3),paddingLeft:e.spacing(3),marginTop:e.spacing(4)}}})),en=function(e){e.location;var t,n,i,r,c,l,s,d,b,h,p,f,m,O,x,g,y,k,w,N,E,S,P,_,L,R=$t(),T=Object(u.g)(),M=Object(a.useContext)(on),G=Object(a.useContext)(ln),q=Object(a.useState)(0),z=Object(o.a)(q,2),W=z[0],F=z[1],J=Object(a.useState)(null),V=Object(o.a)(J,2),U=V[0],H=V[1],K=function(){var e;(e=T.analysis_id,A.a.get(I+"/advise/python/"+e+"/status",{headers:{accept:"application/json"}})).then((function(e){var t=e.data.status;G({type:"advise",param:"status",payload:t}),null!==t.finished_at?H(null):H(null!==U?Math.min(2*U,8e3):null)})).catch((function(e){var t,n;G({type:"error",payload:(null!==(t=null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.statusText)&&void 0!==t?t:"Unknown Error")+": an error occured while fetching Thoth advise status."})}))};Object(a.useEffect)((function(){(null===M||void 0===M?void 0:M.analysis_id)&&T.analysis_id===(null===M||void 0===M?void 0:M.analysis_id)||(G({type:"reset"}),G({type:"advise",param:"analysis_id",payload:T.analysis_id}))}),[T.analysis_id,null===M||void 0===M?void 0:M.analysis_id,G]),Object(a.useEffect)((function(){var e;null===U&&(e=T.analysis_id,A.a.get(I+"/advise/python/"+e,{headers:{accept:"application/json"}})).then((function(e){var t,n=null!==(t=null===e||void 0===e?void 0:e.data)&&void 0!==t?t:e;if(400===e.status||404===e.status)H(null),G({type:"advise",param:"error",payload:n.error});else if(202===e.status)"error"===e.data.status.state?G({type:"advise",param:"status",payload:e.data.status}):H(500);else if(200===e.status){var a;H(null),(null===(a=n.result)||void 0===a?void 0:a.error)&&G({type:"advise",param:"error",payload:n.result.error_msg}),G({type:"advise",param:"initProject",payload:n.result.parameters.project}),G({type:"advise",param:"report",payload:n.result.report}),G({type:"advise",param:"metadata",payload:n.metadata})}else G({type:"advise",param:"error",payload:"Unknown Error: Aborting"})})).catch((function(e){var t,n;G({type:"error",payload:(null!==(t=null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.statusText)&&void 0!==t?t:"Unknown Error")+": an error occured while fetching Thoth advise results."})}))}),[T.analysis_id,G,U]),function(e,t){var n=Object(a.useRef)();Object(a.useEffect)((function(){n.current=e}),[e]),Object(a.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t])}((function(){K()}),U),It(null===M||void 0===M||null===(t=M.advise)||void 0===t||null===(n=t.report)||void 0===n||null===(i=n.products)||void 0===i||null===(r=i[0])||void 0===r||null===(c=r.project)||void 0===c||null===(l=c.requirements)||void 0===l?void 0:l.packages,null===M||void 0===M||null===(s=M.advise)||void 0===s||null===(d=s.report)||void 0===d||null===(b=d.products)||void 0===b||null===(h=b[0])||void 0===h||null===(p=h.project)||void 0===p||null===(f=p.requirements_locked)||void 0===f?void 0:f.default,"adviseGraph"),It(null===M||void 0===M||null===(m=M.advise)||void 0===m||null===(O=m.initProject)||void 0===O||null===(x=O.requirements)||void 0===x?void 0:x.packages,null===M||void 0===M||null===(g=M.advise)||void 0===g||null===(y=g.initProject)||void 0===y||null===(k=y.requirements_locked)||void 0===k?void 0:k.default,"initGraph"),function(e,t){var n=Object(a.useContext)(ln),i=Object(a.useContext)(on);Object(a.useEffect)((function(){var e,t,a,r,c;if((null===i||void 0===i||null===(e=i.advise)||void 0===e?void 0:e.metadata)&&(null===i||void 0===i?void 0:i.mergedGraph)){var o={added:0,removed:0,version:0,equal:0,justification:{},build:null};i.mergedGraph.forEach((function(e){switch(e.change){case"added":o.added++;break;case"removed":o.removed++;break;case"version":o.version++;break;default:o.equal++}})),o.build="We have analysed an application stack running on ".concat(i.advise.metadata.os_release.name," ").concat(i.advise.metadata.os_release.version,", running Python (").concat(i.advise.metadata.python.implementation_name,") ").concat(i.advise.metadata.python.major,".").concat(i.advise.metadata.python.minor,".").concat(i.advise.metadata.python.micro,". It was Adviser Job ID ").concat(i.advise.metadata.document_id,", by ").concat(i.advise.metadata.analyzer," v").concat(i.advise.metadata.analyzer_version,". "),null===(t=i.advise)||void 0===t||null===(a=t.report)||void 0===a||null===(r=a.products)||void 0===r||null===(c=r[0])||void 0===c||c.justification.forEach((function(e){"INFO"!==e.type&&(void 0!==(null===o||void 0===o?void 0:o.justification[e.type])?o.justification[e.type]++:o.justification[e.type]=0)})),n({type:"metric",metric:"advise",payload:o})}}),[i.mergedGraph,i.advise,n]);var r=Object(a.useState)(),c=Object(o.a)(r,2),l=c[0],s=c[1];Object(a.useEffect)((function(){D().then((function(e){s(e)})).catch((function(){return s({})}))}),[]),Object(a.useEffect)((function(){if(e&&t&&l){var a={all:{},roots:{}},i={total:void 0,all:{}};Object.keys(t).forEach((function(n){var r=e.graphSearch(e.nodes.get(n));Array.from(r).forEach((function(e){var r,c,o,s,d,u,j,v,b,h,p,f,m,O,x,g=0===e.value.depth||t[e.value.id]?"roots":1===e.value.depth?"direct":"indirect";a={all:Object(C.a)(Object(C.a)({},a.all),{},Object(St.a)({},g,(null!==(r=a.all[g])&&void 0!==r?r:0)+1)),roots:Object(C.a)(Object(C.a)({},a.roots),{},Object(St.a)({},n,Object(C.a)(Object(C.a)({},null!==(c=a.roots[n])&&void 0!==c?c:null),{},Object(St.a)({},g,(null!==(o=null===(s=a.roots)||void 0===s||null===(d=s[n])||void 0===d?void 0:d[g])&&void 0!==o?o:0)+1))))};var y=void 0;l.licenses&&(y=l.licenses.find((function(t){var n=e.value.metadata.license.toLowerCase();return t.name.toLowerCase()===n||t.licenseId.toLowerCase()===n}))),i={total:(null!==(u=i.total)&&void 0!==u?u:0)+1,root:null!==(j=i.root)&&void 0!==j?j:e.value.metadata.license,all:Object(C.a)(Object(C.a)({},i.all),{},Object(St.a)({},null!==(v=null===(b=y)||void 0===b?void 0:b.licenseId)&&void 0!==v?v:e.value.metadata.license,Object(C.a)(Object(C.a)({},null!==(h=i.all[e.value.metadata.license])&&void 0!==h?h:null),{},(x={},Object(St.a)(x,e.value.label,e.value.depth),Object(St.a)(x,"_found",void 0!==y),Object(St.a)(x,"_isOsiApproved",null!==(p=null===(f=y)||void 0===f?void 0:f.isOsiApproved)&&void 0!==p?p:null),Object(St.a)(x,"_isFsfLibre",null!==(m=null===(O=y)||void 0===O?void 0:O.isFsfLibre)&&void 0!==m?m:null),x))))}}))})),n({type:"metric",metric:"dependencies",payload:a}),n({type:"metric",metric:"licenses",payload:i})}}),[e,n,t,l])}(M.adviseGraph,null===M||void 0===M||null===(w=M.advise)||void 0===w||null===(N=w.report)||void 0===N||null===(E=N.products)||void 0===E||null===(S=E[0])||void 0===S||null===(P=S.project)||void 0===P||null===(_=P.requirements)||void 0===_?void 0:_.packages),console.log(M);return Object(v.jsxs)("div",{className:R.root,children:[(null===M||void 0===M?void 0:M.focus)?Object(v.jsx)(Je,{}):Object(v.jsx)(Qe,{adviseID:T.analysis_id}),null===M||void 0===M||null===(L=M.roots)||void 0===L?void 0:L.map((function(e){return e.error?Object(v.jsx)(j.a,{color:"error",gutterBottom:!0,variant:"body2",children:e.error}):null})),Object(v.jsx)(j.a,{color:"error",children:null===M||void 0===M?void 0:M.error}),Object(v.jsxs)(Dt.a,{value:W,onChange:function(e,t){F(t)},indicatorColor:"primary",textColor:"primary",children:[Object(v.jsx)(Gt.a,{label:"Overview"}),Object(v.jsx)(Gt.a,{label:"Dependencies"})]}),Object(v.jsx)(B,{value:W,index:0,children:Object(v.jsx)(Re,{})}),Object(v.jsx)(B,{value:W,index:1,children:Object(v.jsx)(Xt,{})})]})},tn=function(){return Object(v.jsxs)(u.c,{children:[Object(v.jsx)(u.a,{exact:!0,path:"/",component:U}),Object(v.jsx)(u.a,{exact:!0,path:"/dashboard/:analysis_id",component:en}),Object(v.jsx)(u.a,{path:"*",status:404,children:Object(v.jsx)(b,{})})]})},nn=n(294),an=n(277);function rn(e,t){switch(t.type){case"graph":return Object(C.a)(Object(C.a)({},e),{},Object(St.a)({},t.name,t.payload));case"metric":return Object(C.a)(Object(C.a)({},e),{},{metrics:Object(C.a)(Object(C.a)({},e.metrics),{},Object(St.a)({},t.metric,t.payload))});case"error":return Object(C.a)(Object(C.a)({},e),{},{error:t.payload});case"advise":return Object(C.a)(Object(C.a)({},e),{},{advise:Object(C.a)(Object(C.a)({},e.advise),{},Object(St.a)({},t.param,t.payload))});case"packageWarning":return Object(C.a)(Object(C.a)({},e),{},{packageWarning:t.payload});case"reset":return cn;case"localStorage":return t.payload;default:return e}}var cn={},on=i.a.createContext(),ln=i.a.createContext();var sn=function(){var e=Object(a.useReducer)(rn,cn),t=Object(o.a)(e,2),n=t[0],i=t[1];return Object(v.jsxs)(nn.a,{theme:s,children:[Object(v.jsx)(an.a,{}),Object(v.jsx)(d.a,{basename:"/thoth-search",children:Object(v.jsx)(on.Provider,{value:n,children:Object(v.jsx)(ln.Provider,{value:i,children:Object(v.jsx)(tn,{})})})})]})};c.a.render(Object(v.jsx)(i.a.StrictMode,{children:Object(v.jsx)(sn,{})}),document.getElementById("root"))}},[[198,1,2]]]);
//# sourceMappingURL=main.76a7d406.chunk.js.map