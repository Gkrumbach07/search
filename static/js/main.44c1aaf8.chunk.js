(this["webpackJsonpthoth-search"]=this["webpackJsonpthoth-search"]||[]).push([[0],{172:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(48),o=n.n(i),c=n(10),s=n(117),l=Object(s.a)({palette:{background:{default:"#f9f9f9"}}}),d=n(65),u=n(17),j=n(251),b=n(1),v=function(e){var t=e.text;return Object(b.jsxs)(j.a,{variant:"h2",children:["404: ",null!==t&&void 0!==t?t:"page"," not found!"]})},f=n(22),p=n.n(f),h=n(44),m=n(252),O=n(255),g=n(256),x=n(250),y=n(246),k=n(244),w=n(239),N=n(16),C=n(238),E=Object(w.a)((function(e){return{root:{display:"flex",flexDirection:"column",alignItems:"stretch",flexGrow:1}}})),P=function(e){var t=e.onChange,n=e.label,a=e.helperText,r=e.boxprops,i=e.error,o=void 0!==i&&i,c=E();return Object(b.jsx)(m.a,Object(N.a)(Object(N.a)({className:c.root},r),{},{children:Object(b.jsx)(C.a,Object(N.a)({variant:"outlined",label:n,onChange:function(e){return t(e.target.value)},helperText:a,error:o},e))}))},S=n(39),_=["children","value","index"],B=function(e){var t=e.children,n=e.value,a=e.index,r=Object(S.a)(e,_);return Object(b.jsx)("div",Object(N.a)(Object(N.a)({role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a),className:"".concat(r.className)},r),{},{children:n===a&&t}))},A=n(45),R=n.n(A),L="https://pypi.org/pypi",T="https://api.moc.thoth-station.ninja/api/v1",M=n(83),D=n.n(M);var I=function(e,t){return R.a.get(L+"/"+e+(t?"/"+t:"")+"/json")},W=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"https://pypi.org/simple";return R.a.get(T+"/python/package/metadata",{params:{name:e,version:t,index:n},headers:{accept:"application/json"}}).then((function(e){return e.data.metadata})).catch((function(n){var a;if(404===(null===n||void 0===n||null===(a=n.response)||void 0===a?void 0:a.status))return R.a.get(L+"/"+e+(t?"/"+t:"")+"/json").then((function(e){return e.data.info}))}))},z=function(e,t){var n={application_stack:{requirements:e,requirements_format:"pipenv",requirements_lock:t},runtime_environment:{operating_system:{name:"ubi",version:"8"},platform:"linux-x86_64",python_version:"3.6"}};return R.a.post(T+"/advise/python",n,{params:{recommendation_type:"stable"},headers:{accept:"application/json"}})},q=function(e,t){return R.a.get(T+"/python/package/versions",{params:{name:e},timeout:5e3,headers:{accept:"application/json"}}).then((function(e){if(0===e.data.versions.length)return null;var n=e.data.versions.sort((function(e,t){return D()(e.package_version,t.package_version)}));return t&&n.includes(t)?t:n[n.length-1].package_version})).catch((function(){return null}))};function F(e,t){return V.apply(this,arguments)}function V(){return(V=Object(h.a)(p.a.mark((function e(t,n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I(t,n).then(function(){var e=Object(h.a)(p.a.mark((function e(a){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q(t,n).then((function(e){return null===e?{metadata:a.data,error:"Thoth currently does not support '"+a.data.info.name+"'."}:D()(a.data.info.version,e)>0?{metadata:a.data,thothVersion:e,error:"Thoth currently supports '"+a.data.info.name+"' up to version "+e+", while the most recent version of '"+a.data.info.name+"' is "+a.data.info.version+"."}:{metadata:a.data}})).catch((function(){return null}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(){return null}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var U=Object(w.a)((function(e){return{root:{display:"flex",flexFlow:"column nowrap",alignItems:"center",marginTop:"10%"},stretchContent:{minWidth:"50%"},searchBar:{display:"flex",justifyContent:"center"},flexColumn:{display:"flex",flexDirection:"column"},multilineTextBoxContainer:{display:"flex",justifyContent:"space-between"},description:{marginBottom:e.spacing(1),maxWidth:"50%",textAlign:"center"},mode:{marginBottom:e.spacing(3)},title:{marginBottom:e.spacing(1)}}})),G=function(){var e=Object(u.f)(),t=U(),n=Object(a.useContext)(xt),r=Object(a.useState)(""),i=Object(c.a)(r,2),o=i[0],s=i[1],l=Object(a.useState)(""),d=Object(c.a)(l,2),v=d[0],f=d[1],w=Object(a.useState)(""),N=Object(c.a)(w,2),C=N[0],E=N[1],S=Object(a.useState)(""),_=Object(c.a)(S,2),A=_[0],R=_[1],L=Object(a.useState)(""),T=Object(c.a)(L,2),M=T[0],D=T[1],I=Object(a.useState)(""),W=Object(c.a)(I,2),q=W[0],V=W[1],G=Object(a.useState)("multiple"),J=Object(c.a)(G,2),H=J[0],K=J[1],Y=Object(a.useState)(!1),Z=Object(c.a)(Y,2),Q=Z[0],X=Z[1],$=Object(a.useState)(!1),ee=Object(c.a)($,2),te=ee[0],ne=ee[1],ae=function(e,t){switch(t){case"single":s(e.target.value),""!==A&&R("");break;case"pipfile":f(e.target.value),""!==M&&D("");break;case"lock":E(e.target.value),""!==q&&V("")}},re=function(){var t=Object(h.a)(p.a.mark((function t(){var a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("single"!==H){t.next=6;break}if(""!==o){t.next=3;break}return t.abrupt("return");case 3:F(o).then((function(){})).catch((function(){R("Package does not exist")})),t.next=12;break;case 6:if(""!==v&&""!==C&&""===M&&""===q){t.next=8;break}return t.abrupt("return");case 8:a=!1,v||(a=!0,D("Please provide a Pipfile")),C||(a=!0,V("Please provide a Pipfile.lock")),a||(ne(!0),z(v,C).then((function(t){ne(!1),n({type:"advise",param:"analysis_id",payload:t.data.analysis_id}),e.push("/dashboard/"+t.data.analysis_id)})).catch((function(e){ne(!1),400===e.response.status&&(e.response.data.error.includes("Pipfile.lock")?V("Failed to parse provided Pipfile.lock"):e.response.data.error.includes("Pipfile")&&D("Failed to parse provided Pipfile"))})));case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(b.jsxs)("div",{className:t.root,children:[Object(b.jsx)(j.a,{variant:"h4",className:t.title,children:Object(b.jsx)("b",{children:"Thoth Search"})}),Object(b.jsxs)(j.a,{variant:"body1",className:t.description,children:["Thoth Search is a tool that runs analysis on a Python application. It utilizes package metadata and Thoth Adviser to analyse and recommend a software stack. ",Object(b.jsx)("br",{}),Object(b.jsx)("br",{})," You can run analysis on a specific Python package or you can provide a properly formatted Pipfile and/or Pipfile.lock to run analysis on an entire Python application."]}),Object(b.jsxs)(k.a,{value:H,exclusive:!0,onChange:function(e,t){t&&K(t)},size:"small",className:t.mode,children:[Object(b.jsx)(y.a,{value:"single","aria-label":"left aligned",disabled:!0,children:Object(b.jsx)("b",{children:"Single Package"})}),Object(b.jsx)(y.a,{value:"multiple","aria-label":"centered",children:Object(b.jsx)("b",{children:"Multiple Packages"})})]}),Object(b.jsxs)(B,{value:H,index:"single",className:"".concat(t.flexColumn," ").concat(t.stretchContent),children:[Object(b.jsxs)(m.a,{className:t.searchBar,children:[Object(b.jsx)(P,{label:"Search for a Python package",onChange:function(e){return ae(e,"single")},helperText:A,error:""!==A,type:"search",boxprops:{mr:2}}),Object(b.jsx)(O.a,{variant:"contained",color:"primary",onClick:function(){return re()},children:Object(b.jsx)("b",{children:"Analyze"})})]}),Object(b.jsx)(g.a,{in:Q,timeout:"auto",unmountOnExit:!0,children:Object(b.jsx)(m.a,{mt:1})}),Object(b.jsx)(m.a,{textAlign:"center",mt:1,children:Object(b.jsx)(O.a,{onClick:function(){return X(!Q)},color:"primary",children:Q?"Less Options":"More Options"})})]}),Object(b.jsxs)(B,{value:H,index:"multiple",className:"".concat(t.flexColumn," ").concat(t.stretchContent),children:[Object(b.jsxs)(m.a,{className:t.multilineTextBoxContainer,children:[Object(b.jsx)(P,{label:"Pipfile contents",onChange:function(e){return ae(e,"pipfile")},helperText:M,error:""!==M,multiline:!0,rows:8,boxprops:{mr:1}}),Object(b.jsx)(P,{label:"Pipfile.lock contents",onChange:function(e){return ae(e,"lock")},helperText:q,error:""!==q,multiline:!0,rows:8,boxprops:{ml:1}})]}),Object(b.jsx)(m.a,{textAlign:"center",mt:2,children:Object(b.jsx)(x.a,{variant:"contained",color:"primary",onClick:function(){return re()},loading:te,children:Object(b.jsx)("b",{children:"Analyze"})})})]})]})},J=n(258),H=n(259),K=n(260),Y=Object(w.a)({root:{minWidth:275},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{fontSize:14},pos:{marginBottom:12}}),Z=function(e){var t=e.cardMeta,n=e.cardBody,a=Y();return Object(b.jsxs)(J.a,{className:a.root,children:[Object(b.jsx)(H.a,{action:t.action,title:t.title,subheader:t.subTitle}),Object(b.jsx)(K.a,{children:n})]})},Q=n(249),X=n(261),$=n(237),ee=["value","total","label","action"],te=Object(Q.a)((function(e){return{root:{height:10,borderRadius:5},colorPrimary:{backgroundColor:e.palette.grey["light"===e.palette.type?200:700]},bar:{borderRadius:5,backgroundColor:"#1a90ff"}}}))(X.a),ne=Object(w.a)((function(e){return{root:{display:"grid",gridTemplateColumns:"repeat(6,1fr)",alignItems:"center",gridGap:e.spacing(1)},label:{gridColumnStart:1,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},value:{gridColumnStart:2,textAlign:"end"},bar:{gridColumnStart:"span 3"},end:{gridColumnStart:6}}})),ae=function(e){var t=e.value,n=e.total,a=e.label,r=e.action,i=Object(S.a)(e,ee),o=ne();return Object(b.jsxs)("div",{className:"".concat(o.root," ").concat(i.className),children:[Object(b.jsx)($.a,{title:a,placement:"left",children:Object(b.jsx)(j.a,{variant:"body2",className:o.label,children:a})}),Object(b.jsx)(j.a,{className:o.value,variant:"body2",children:t}),Object(b.jsx)(te,{variant:"determinate",value:n>0?t/n*100:0,className:o.bar}),Object(b.jsx)("div",{className:o.end,children:null!==r&&void 0!==r?r:null})]})},re=n(262),ie=n(254),oe=n(243),ce=n(263),se=Object(w.a)((function(e){return{bar:{marginBottom:e.spacing(1)},header:{marginTop:e.spacing(3)},flex:{display:"flex",flexDirection:"column"}}})),le=function(e){var t,n,a,r,i,o,s=e.metric,l=se(),d=(null!==(t=s.all.direct)&&void 0!==t?t:0)+(null!==(n=s.all.indirect)&&void 0!==n?n:0)+(null!==(a=s.all.roots)&&void 0!==a?a:0);return Object(b.jsxs)("div",{children:[Object(b.jsx)(j.a,{variant:"body2",gutterBottom:!0,children:Object(b.jsx)("b",{children:"All Packages"})}),Object(b.jsx)(re.a,{className:l.bar}),Object(b.jsx)(ae,{value:null!==(r=s.all.roots)&&void 0!==r?r:0,total:d,label:"Root",className:l.bar}),Object(b.jsx)(ae,{value:null!==(i=s.all.direct)&&void 0!==i?i:0,total:d,label:"Direct",className:l.bar}),Object(b.jsx)(ae,{value:null!==(o=s.all.indirect)&&void 0!==o?o:0,total:d,label:"Indirect"}),Object(b.jsx)(j.a,{variant:"body2",className:l.header,gutterBottom:!0,children:Object(b.jsx)("b",{children:"Root Packages"})}),Object(b.jsx)(re.a,{className:l.bar}),Object(b.jsx)(ie.a,{component:"nav",children:Object.entries(s.roots).map((function(e,t){var n,a,r,i,o=Object(c.a)(e,2),d=o[0],u=(o[1],(null!==(n=s.roots[d].direct)&&void 0!==n?n:0)+(null!==(a=s.roots[d].indirect)&&void 0!==a?a:0));return Object(b.jsxs)("div",{children:[Object(b.jsxs)(oe.a,{children:[Object(b.jsx)(ce.a,{primary:d}),Object(b.jsxs)("div",{className:l.flex,children:[Object(b.jsx)(ae,{value:null!==(r=s.roots[d].direct)&&void 0!==r?r:0,total:u,label:"Direct",className:l.bar}),Object(b.jsx)(ae,{value:null!==(i=s.roots[d].indirect)&&void 0!==i?i:0,total:u,label:"Indirect"})]})]}),Object(b.jsx)(re.a,{variant:"middle",className:l.bar})]},d)}))})]})},de=Object(w.a)((function(e){return{bar:{marginBottom:e.spacing(1)}}})),ue=function(e){var t,n,a,r,i=e.metric,o=de(),c=(null!==(t=i.all.direct)&&void 0!==t?t:0)+(null!==(n=i.all.indirect)&&void 0!==n?n:0);return Object(b.jsxs)("div",{children:[Object(b.jsx)(ae,{value:null!==(a=i.all.direct)&&void 0!==a?a:0,total:c,label:"Direct",className:o.bar}),Object(b.jsx)(ae,{value:null!==(r=i.all.indirect)&&void 0!==r?r:0,total:c,label:"Indirect"})]})},je=n(257),be=function(e){var t=e.text;return Object(b.jsx)(j.a,{align:"center",color:"error",variant:"body1",children:t})},ve=Object(w.a)((function(e){return{customProgressRoot:{display:"flex",flexDirection:"column",alignItems:"center"}}})),fe=function(e){var t=e.amount,n=e.note,a=ve();return Object(b.jsxs)("div",{className:a.customProgressRoot,children:[Object(b.jsx)(je.a,{variant:t?"determinate":"indeterminate",value:null!==t&&void 0!==t?t:0}),n?Object(b.jsx)(j.a,{align:"center",variant:"body1",children:n}):null]})},pe=function(e){var t=e.isError,n=e.isLoading,a=e.errorText,r=e.loadingPage,i=e.loadingAmount,o=e.loadingText,c=e.children;return Object(b.jsx)(b.Fragment,{children:t?Object(b.jsx)(be,{text:null!==a&&void 0!==a?a:"A unknown error occured"}):n?null!==r&&void 0!==r?r:Object(b.jsx)(fe,{amount:i,note:o}):c})},he=function(){var e,t=Object(a.useContext)(gt);return Object(b.jsx)(pe,{isLoading:null===(e=t.metrics)||void 0===e?void 0:e.licences,children:(null===t||void 0===t?void 0:t.focus)?Object(b.jsx)(ue,{metric:t.metrics.dependencies}):Object(b.jsx)(le,{metric:t.metrics.dependencies})})},me=n(247),Oe=n(111),ge=n.n(Oe),xe=n(112),ye=n.n(xe),ke=Object(w.a)((function(e){return{bar:{marginBottom:e.spacing(1)},marginBottom:{marginBottom:e.spacing(2)},chip:{margin:e.spacing(.5)},border:{marginTop:e.spacing(1),marginBottom:e.spacing(1)}}})),we=function(e){var t,n=e.name,a=e.value,i=e.totalLicenses,o=ke(),s=r.a.useState(!1),l=Object(c.a)(s,2),d=l[0],u=l[1];return Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{className:o.flex,onClick:function(){return u(!d)},children:Object(b.jsx)(ae,{value:null!==(t=Object.keys(a).length)&&void 0!==t?t:0,total:i,label:n,className:o.bar,action:d?Object(b.jsx)(ge.a,{}):Object(b.jsx)(ye.a,{})},n)}),Object(b.jsxs)(g.a,{in:d,timeout:"auto",unmountOnExit:!0,children:[Object(b.jsx)("div",{className:o.border,children:Object.entries(a).sort((function(e,t){return e[1]-t[1]})).map((function(e){var t=Object(c.a)(e,2),n=t[0],a=t[1];return Object(b.jsx)(me.a,{className:o.chip,color:0===a?"primary":1===a?"secondary":"default",label:n,onClick:null},n)}))}),Object(b.jsx)(re.a,{})]})]})},Ne=function(e){var t,n,a=e.metric,i=e.deepError,o=ke(),s=r.a.useState(!1),l=Object(c.a)(s,2),d=l[0],u=l[1],v=Object.entries(null!==(t=null===a||void 0===a?void 0:a.all)&&void 0!==t?t:{}).sort((function(e,t){return Object.keys(t[1]).length-Object.keys(e[1]).length})),f=Object.entries(null!==(n=null===a||void 0===a?void 0:a.all)&&void 0!==n?n:{}).reduce((function(e,t){return e+Object.keys(t[1]).length}),0);return Object(b.jsxs)("div",{className:o.root,children:[Object(b.jsx)(j.a,{variant:"body2",gutterBottom:!0,children:Object(b.jsx)("b",{children:"Dependency Licenses"})}),Object(b.jsx)(re.a,{}),Object(b.jsxs)(pe,{state:i?"error":a.all,errorText:"Could not run analysis on dependencies.",children:[v.slice(0,10).map((function(e){var t=Object(c.a)(e,2),n=t[0],a=t[1];return Object(b.jsx)(we,{name:n,value:a,totalLicenses:f},n)})),Object(b.jsx)(g.a,{in:d,timeout:"auto",unmountOnExit:!0,children:v.slice(10).map((function(e){var t=Object(c.a)(e,2),n=t[0],a=t[1];return Object(b.jsx)(we,{name:n,value:a,totalLicenses:f},n)}))}),Object(b.jsx)(m.a,{textAlign:"center",children:Object(b.jsx)(O.a,{onClick:function(){return u(!d)},color:"primary",children:d?"Less":"More"})})]})]})},Ce=Object(w.a)((function(e){return{bar:{marginBottom:e.spacing(1)},marginBottom:{marginBottom:e.spacing(2)}}})),Ee=function(e){var t,n=e.metric,a=Ce();return Object(b.jsxs)("div",{className:a.root,children:[Object(b.jsx)(j.a,{variant:"body2",gutterBottom:!0,children:Object(b.jsx)("b",{children:"License"})}),Object(b.jsx)(re.a,{}),Object(b.jsx)(j.a,{className:a.marginBottom,variant:"h6",children:n.root}),Object(b.jsx)(j.a,{variant:"body2",gutterBottom:!0,children:Object(b.jsx)("b",{children:"Dependency Licenses"})}),Object(b.jsx)(re.a,{}),Object.entries(null!==(t=null===n||void 0===n?void 0:n.all)&&void 0!==t?t:{}).map((function(e){var t,r=Object(c.a)(e,2),i=r[0],o=r[1];return Object(b.jsx)(ae,{value:null!==(t=Object.keys(o).length)&&void 0!==t?t:0,total:n.total,label:i,className:a.bar},i)}))]})},Pe=function(){var e,t=Object(a.useContext)(gt);return Object(b.jsx)(pe,{isLoading:null===(e=t.metrics)||void 0===e?void 0:e.licences,children:(null===t||void 0===t?void 0:t.focus)?Object(b.jsx)(Ee,{metric:t.metrics.licenses}):Object(b.jsx)(Ne,{metric:t.metrics.licenses})})},Se=n(248),_e=function(){var e=Object(a.useContext)(gt);return Object(b.jsx)(pe,{isLoading:void 0===(null===e||void 0===e?void 0:e.metrics),children:Object(b.jsx)(Se.a,{container:!0,spacing:3,children:(null===e||void 0===e?void 0:e.metrics)?Object.keys(e.metrics).map((function(e){return Object(b.jsx)(Se.a,{item:!0,xs:12,sm:6,children:Object(b.jsx)(Z,{cardMeta:{title:e.charAt(0).toUpperCase()+e.slice(1)},cardBody:"dependencies"===e?Object(b.jsx)(he,{}):"licenses"===e?Object(b.jsx)(Pe,{}):null})},e)})):null})})},Be=n(113),Ae=n.n(Be),Re=n(114),Le=n.n(Re),Te=["text","icon","link"],Me=Object(w.a)((function(e){return{root:{display:"flex",alignItems:"center"}}})),De=function(e){var t=e.text,n=e.icon,a=e.link,r=Object(S.a)(e,Te),i=Me();return Object(b.jsxs)("div",{className:"".concat(i.root," ").concat(r.className),children:[n,Object(b.jsx)(j.a,{href:a||null,variant:"body2",marginLeft:!0,children:t})]})};function Ie(e){var t=Math.floor((new Date-e)/1e3),n=t/31536e3;if(n>1){var a=Math.floor(n);return a+" year"+(1!==a?"s":"")}if((n=t/2592e3)>1){var r=Math.floor(n);return r+" month"+(1!==r?"s":"")}if((n=t/86400)>1){var i=Math.floor(n);return i+" day"+(1!==i?"s":"")}if((n=t/3600)>1){var o=Math.floor(n);return o+" hour"+(1!==o?"s":"")}if((n=t/60)>1){var c=Math.floor(n);return c+" minute"+(1!==c?"s":"")}var s=Math.floor(t);return s+" second"+(1!==s?"s":"")}var We=Object(w.a)((function(e){return{titleRow:{display:"flex",alignItems:"center",marginBottom:e.spacing(1)},marginLeft:{marginLeft:e.spacing(2)},marginRight:{marginRight:e.spacing(2)},linksRow:{display:"flex",marginBottom:e.spacing(3)},warning:{display:"flex"}}})),ze=function(){var e,t,n,r,i,o,c,s,l,d,u,v,f,p,h,m,O,g,x=We(),y=Object(a.useContext)(gt),k=y.roots,w=y.packageWarning;return Object(b.jsxs)("div",{children:[Object(b.jsxs)("div",{className:x.titleRow,children:[Object(b.jsx)(j.a,{variant:"h4",children:Object(b.jsx)("b",{children:null===(e=k[0])||void 0===e||null===(t=e.metadata)||void 0===t?void 0:t.name})}),Object(b.jsxs)(j.a,{className:x.marginLeft,variant:"subtitle1",children:["v",null!==(n=null===(r=k[0])||void 0===r||null===(i=r.metadata)||void 0===i?void 0:i.version)&&void 0!==n?n:"NaN"]})]}),Object(b.jsx)(j.a,{gutterBottom:!0,variant:"body1",children:null!==(o=null===(c=k[0])||void 0===c||null===(s=c.metadata)||void 0===s?void 0:s.summary)&&void 0!==o?o:"NaN"}),Object(b.jsxs)("div",{className:x.linksRow,children:[Object(b.jsx)(De,{text:null!==(l=null===(d=k[0])||void 0===d||null===(u=d.metadata)||void 0===u?void 0:u.license)&&void 0!==l?l:"NaN",icon:Object(b.jsx)(Ae.a,{})}),Object(b.jsx)(De,{className:x.marginLeft,text:"Latest version published "+Ie(new Date(null===(v=k[0])||void 0===v||null===(f=v.metadata)||void 0===f||null===(p=f.releases)||void 0===p||null===(h=p[null===(O=k[0])||void 0===O||null===(g=O.metadata)||void 0===g?void 0:g.version])||void 0===h||null===(m=h[0])||void 0===m?void 0:m.upload_time))+" ago.",icon:Object(b.jsx)(Le.a,{})})]}),w&&0!==w.length?w.map((function(e){return Object(b.jsxs)(j.a,{gutterBottom:!0,color:"error",className:x.marginRight,variant:"body2",children:["Dependency ",Object(b.jsx)("i",{children:w[0].value.label})," ",Object(b.jsx)("i",{children:w[0].value.metadata.version})," is currently not supported by Thoth."]})})):null]})},qe=n(240),Fe=n(115),Ve=n.n(Fe),Ue=["info"],Ge=Object(w.a)((function(e){return{titleRow:{display:"flex",alignItems:"center",marginBottom:e.spacing(1)},marginLeft:{marginLeft:e.spacing(2)},marginRight:{marginRight:e.spacing(2)},linksRow:{display:"flex",marginBottom:e.spacing(3),alignItems:"center"},alert:{width:"100%",marginTop:e.spacing(1)}}})),Je=function(e){var t=e.info,n=Object(S.a)(e,Ue);return Object(b.jsx)(qe.a,{className:n.className,action:Object(b.jsx)(O.a,{color:"inherit",size:"small",href:t.link,children:"DETAILS"}),severity:t.type.toLowerCase(),children:t.message})},He=function(e){var t,n,i=e.adviseID,o=Ge(),s=Object(a.useContext)(gt),l=r.a.useState(!1),d=Object(c.a)(l,2),u=d[0],v=d[1],f=function(){var e,t,n;return(null===s||void 0===s||null===(e=s.advise)||void 0===e?void 0:e.report)?s.advise.report.ERROR?["ERROR","error"]:["COMPLETE","success"]:(null===s||void 0===s||null===(t=s.advise)||void 0===t||null===(n=t.status)||void 0===n?void 0:n.state)?[s.advise.status.state.toUpperCase(),"info"]:["UNKNOWN",void 0]}(),p=Object(c.a)(f,2),h=p[0],m=p[1],x=(null===s||void 0===s||null===(t=s.advise)||void 0===t||null===(n=t.report)||void 0===n?void 0:n.stack_info)?s.advise.report.stack_info.filter((function(e){return"ERROR"===e.type})):null;return Object(b.jsxs)("div",{children:[Object(b.jsx)(j.a,{variant:"h4",children:Object(b.jsx)("b",{children:i})}),Object(b.jsxs)("div",{className:o.linksRow,children:[Object(b.jsx)(me.a,{label:h,color:m}),Object(b.jsx)(De,{className:o.marginLeft,text:function(){var e,t,n,a,r,i;return(null===s||void 0===s||null===(e=s.advise)||void 0===e||null===(t=e.status)||void 0===t?void 0:t.finished_at)?"Advise finished "+Ie(new Date(s.advise.status.finished_at))+" ago.":(null===s||void 0===s||null===(n=s.advise)||void 0===n||null===(a=n.status)||void 0===a?void 0:a.started_at)?"Advise started "+Ie(new Date(s.advise.status.started_at))+" ago.":(null===s||void 0===s||null===(r=s.advise)||void 0===r||null===(i=r.metadata)||void 0===i?void 0:i.datetime)?"Advise finished "+Ie(new Date(s.advise.metadata.datetime+"Z"))+" ago.":"Time started/finished not available"}(),icon:Object(b.jsx)(Ve.a,{})})]}),(null===x||void 0===x?void 0:x.length)>0?Object(b.jsxs)("div",{children:[Object(b.jsx)(Je,{info:x[0]}),Object(b.jsx)(g.a,{in:u,timeout:"auto",unmountOnExit:!0,children:null===x||void 0===x?void 0:x.slice(1).map((function(e){return Object(b.jsx)(Je,{info:e,className:o.alert})}))}),Object(b.jsx)(O.a,{color:"inherit",size:"small",onClick:function(){return v(!u)},children:(null===x||void 0===x?void 0:x.length)>1?u?"LESS":"MORE":null})]}):null]})},Ke=n(14);function Ye(e,t,n){var a=n.filter((function(t){return e.includes(t.from)})),r={nodes:[],edges:[]};return a.forEach((function(e){var a=Ze(e,{nodes:[],edges:[]},n,t);r={nodes:Object(Ke.a)(new Set([].concat(Object(Ke.a)(a.nodes),Object(Ke.a)(r.nodes)))),edges:Object(Ke.a)(new Set([].concat(Object(Ke.a)(a.edges),Object(Ke.a)(r.edges))))}})),r}function Ze(e,t,n,a){if(t.edges.includes(e.id))return t;if(t.nodes.push(e.from,e.to),t.edges.push(e.id),e.to===a)return t;var r={nodes:[],edges:[]};return n.filter((function(t){return t.from===e.to})).forEach((function(e){var i=Ze(e,t,n,a);r={nodes:Object(Ke.a)(new Set([].concat(Object(Ke.a)(i.nodes),Object(Ke.a)(r.nodes)))),edges:Object(Ke.a)(new Set([].concat(Object(Ke.a)(i.edges),Object(Ke.a)(r.edges))))}})),r}var Qe={manipulation:{enabled:!1,editNode:function(e,t){e.fixed=!e.fixed.x,t(e)}},interaction:{hover:!0,hoverConnectedEdges:!1,selectConnectedEdges:!1,selectable:!1},edges:{chosen:!1,smooth:!1,color:{color:"#5c6470"},arrowStrikethrough:!1,arrows:{from:{enabled:!0,type:"triangle"}}},nodes:{chosen:!1,color:{background:"#5c6470",border:"#fff",hover:{background:"#f39200",border:"#fff"}},shape:"dot",size:10,borderWidth:2,labelHighlightBold:!1,font:{color:"#393e46",strokeWidth:2,size:15}},physics:{hierarchicalRepulsion:{damping:.1,springLength:200},solver:"hierarchicalRepulsion",minVelocity:.15}},Xe=n(70),$e=["data","searchText","root"],et=Object(w.a)((function(e){return{root:{display:"flex",flexFlow:"column nowrap"},canvas:{flex:"1 1 auto",height:"75vh"}}})),tt=function(e){var t=e.data,n=(e.searchText,e.root),r=Object(S.a)(e,$e),i=Object(a.useRef)(null),o=et();Object(a.useEffect)((function(){var e=i.current&&new Xe.b(i.current,t,Qe),a=t.nodes.get(n);a.color="#4fc1ea",a.font={color:"#4fc1ea",strokeWidth:3,size:20},t.nodes.updateOnly(a);var r=document.getElementById("mynetwork").getElementsByTagName("canvas")[0];function o(e){r.style.cursor=e}e.on("hoverNode",(function(){o("grab")})),e.on("blurNode",(function(){o("default")})),e.on("dragStart",(function(){o("grabbing")})),e.on("dragging",(function(){o("grabbing")})),e.on("dragEnd",(function(){o("grab")})),e.on("dragEnd",(function(t){0!==t.nodes.length&&e.editNode(t.nodes[0])})),e.on("dragStart",(function(t){0!==t.nodes.length&&void 0!==e.body.nodes[t.nodes[0]].options.x&&e.body.nodes[t.nodes[0]].options.x&&e.editNode(t.nodes[0])}))}),[i,t,n]);return Object(b.jsxs)("div",{className:"".concat(o.root," ").concat(r.className),children:[Object(b.jsx)(P,{label:"Filter packages",onChange:function(e){return function(e,t){if(t.nodes.updateOnly(t.nodes.get().map((function(e){return e.id!==n&&(e.color=Qe.nodes.color,e.font=Qe.nodes.font),e}))),t.edges.updateOnly(t.edges.get().map((function(e){return e.color=Qe.edges.color,e}))),""!==e){var a=t.nodes.get({filter:function(t){return t.label.includes(e)}}),r=Ye(a.map((function(e){return e.id})),n,t.edges.map((function(e){return e}))),i=t.edges.get().filter((function(e){return!r.edges.includes(e.id)})).map((function(e){return e.color={color:"#e3e5e8"},e})),o=t.nodes.get().filter((function(e){return!r.nodes.includes(e.id)})).map((function(e){return e.id!==n&&(e.color={background:"#e3e5e8"},e.font={color:"#e3e5e8",strokeWidth:2,size:15}),e}));a=a.map((function(e){return e.id!==n&&(e.color={background:"#f39200"}),e})),t.nodes.updateOnly(o.concat(a)),t.edges.updateOnly(i)}}(e,t)}}),Object(b.jsx)("div",{ref:i,id:"mynetwork",className:o.canvas})]})},nt=n(3),at=n(116),rt=n(57),it=n(58),ot=function(){function e(t,n){Object(rt.a)(this,e),this.adjacents=new Set,this.key=t,this.value=n}return Object(it.a)(e,[{key:"addAdjacent",value:function(e){this.adjacents.add(e)}},{key:"isAdjacent",value:function(e){return this.adjacents.has(e)}},{key:"getAdjacents",value:function(){return Array.from(this.adjacents)}}]),e}(),ct=function(){function e(){Object(rt.a)(this,e),this.nodes=new Map}return Object(it.a)(e,[{key:"addVertex",value:function(e,t){if(this.nodes.has(e))return this.nodes.get(e);var n=new ot(e,t);return this.nodes.set(e,n),n}},{key:"addEdge",value:function(e,t){var n=this.nodes.get(e),a=this.nodes.get(t);return n.addAdjacent(a),[n,a]}},{key:"areAdjacents",value:function(e,t){var n=this.nodes.get(e),a=this.nodes.get(t);return!(!n||!a)&&n.isAdjacent(a)}},{key:"graphSearch",value:p.a.mark((function e(t){var n,a,r,i,o=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=o.length>1&&void 0!==o[1]?o[1]:"bfs",a=new Map,(r=[]).push(t);case 4:if(0===r.length){e.next=13;break}if(!(i="dfs"===n?r.pop():r.shift())||a.has(i)){e.next=11;break}return e.next=9,i;case 9:a.set(i),i.getAdjacents().forEach((function(e){return r.push(e)}));case 11:e.next=4;break;case 13:case"end":return e.stop()}}),e)}))},{key:"findPath",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,a=this.nodes.get(e),r=this.nodes.get(t),i=new Map(n);if(!r||!a)return[];if(i.set(a),e===t)return Array.from(i.keys());var o,c=Object(at.a)(a.getAdjacents());try{for(c.s();!(o=c.n()).done;){var s=o.value;if(!i.has(s)){var l=this.findPath(s.value,t,i);if(l.length)return l}}}catch(d){c.e(d)}finally{c.f()}return[]}},{key:"findAllPaths",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=this.nodes.get(e),i=this.nodes.get(t),o=new Map(a);if(!i||!r)return[];if(o.set(r),e===t)return[Array.from(o.keys())];var c=[];return r.getAdjacents().forEach((function(e){o.has(e)||n.findAllPaths(e.value,t,o).forEach((function(e){return c.push(e)}))})),c}}]),e}();var st=n(253),lt=Object(w.a)((function(e){return{graph:{padding:e.spacing(4)}}})),dt=function(){var e,t=lt(),n=Object(a.useContext)(gt),r=null!==(e=n.focus)&&void 0!==e?e:"*App",i=function(e,t){var n=Object(a.useState)(void 0),r=Object(c.a)(n,2),i=r[0],o=r[1];return Object(a.useEffect)((function(){if(e&&t){var n={nodes:[],edges:[]};t.nodes.forEach((function(e,t,a){var r=a.get(t);n.nodes.push({id:r.value.id,label:r.value.label}),r.adjacents.forEach((function(e){n.edges.push({to:r.value.id,from:e.value.id})}))})),o(n)}}),[e,t]),i}(r,n.graph);return Object(b.jsx)(pe,{isLoading:void 0===i,children:Object(b.jsx)(st.a,{children:Object(b.jsx)(tt,{data:{nodes:new Xe.a(null===i||void 0===i?void 0:i.nodes),edges:new Xe.a(null===i||void 0===i?void 0:i.edges)},className:t.graph,root:r})})})},ut=n(241),jt=n(264),bt=Object(w.a)((function(e){return{root:{flexGrow:1,maxWidth:"95%",marginLeft:"auto",marginRight:"auto",paddingRight:e.spacing(3),paddingLeft:e.spacing(3),marginTop:e.spacing(4)}}})),vt=function(e){e.location;var t,n,r,i,o,s,l,d,v,f,m=bt(),O=Object(u.g)(),g=Object(a.useContext)(gt),x=Object(a.useContext)(xt),y=Object(a.useState)(0),k=Object(c.a)(y,2),w=k[0],C=k[1],E=Object(a.useState)(null),P=Object(c.a)(E,2),S=P[0],_=P[1],A=function(){var e;(e=O.analysis_id,R.a.get(T+"/advise/python/"+e+"/status",{headers:{accept:"application/json"}})).then((function(e){var t=e.data.status;x({type:"advise",param:"status",payload:t}),null!==t.finished_at?_(null):_(null!==S?Math.min(2*S,8e3):null)}))};Object(a.useEffect)((function(){(null===g||void 0===g?void 0:g.analysis_id)&&O.analysis_id===(null===g||void 0===g?void 0:g.analysis_id)||(x({type:"reset"}),x({type:"advise",param:"analysis_id",payload:O.analysis_id}))}),[O.analysis_id,null===g||void 0===g?void 0:g.analysis_id,x]),Object(a.useEffect)((function(){var e;null===S&&(e=O.analysis_id,R.a.get(T+"/advise/python/"+e,{headers:{accept:"application/json"}})).then((function(e){var t=e.data;if(400===e.status||404===e.status)_(null),x({type:"advise",param:"error",payload:t.error});else if(202===e.status)"error"===e.data.status.state?x({type:"advise",param:"status",payload:e.data.status}):_(500);else if(200===e.status){var n;_(null),(null===(n=t.result)||void 0===n?void 0:n.error)&&x({type:"advise",param:"error",payload:t.result.error_msg}),x({type:"advise",param:"initProject",payload:t.result.parameters.project}),x({type:"advise",param:"report",payload:t.result.report}),x({type:"advise",param:"metadata",payload:t.metadata})}else x({type:"advise",param:"error",payload:"Unknown Error: Aborting"})}))}),[O.analysis_id,x,S]),function(e,t){var n=Object(a.useRef)();Object(a.useEffect)((function(){n.current=e}),[e]),Object(a.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t])}((function(){A()}),S),function(e,t){var n=Object(a.useContext)(xt);Object(a.useEffect)((function(){if(e&&t){var a=new ct;Object(h.a)(p.a.mark((function n(){var r,i,o,s,l,d;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=[],n.next=3,Promise.all(Object.entries(t).map(function(){var e=Object(h.a)(p.a.mark((function e(n){var i,o,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(c.a)(n,2),o=i[0],s=i[1],e.next=3,W(o,s.version.replace("==","")).then((function(e){var n,i={id:e.name.toLowerCase(),label:e.name,depth:null,metadata:e};a.addVertex(i.id,i),null===(n=e.requires_dist)||void 0===n||n.forEach((function(e){var n=e.split(" ",1)[0];t[n]&&r.push(n)}))}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:return i=new Map,o=[],a.nodes.forEach((function(t,n,a){if(!r.includes(n)||Object.keys(e).includes(n)){var i=a.get(n);i.value.depth=0,o.push(i)}})),s=function(e,t,n){return function e(a){return t(a)?n().then(e):Promise.resolve(a)}(e)},n.next=9,s(o,(function(e){return e.length>0}),(function(){var e,t,n=o.pop();return n&&!i.has(n)&&(i.set(n),(null===n||void 0===n||null===(e=n.value)||void 0===e||null===(t=e.metadata)||void 0===t?void 0:t.requires_dist)&&n.value.metadata.requires_dist.map(function(){var e=Object(h.a)(p.a.mark((function e(t){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=a.nodes.get(t.split(" ",1)[0]))){e.next=6;break}return r.value.depth=n.value.depth+1,a.addEdge(n.key,r.value.id),e.next=6,o.push(r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),new Promise((function(e,t){e(o)}))}));case 9:l={id:"*App",label:"App",depth:-1},d=a.addVertex(l.id,l),Object.keys(e).forEach((function(e){a.nodes.get(e)&&a.addEdge(d.key,e)}));case 12:case"end":return n.stop()}}),n)})))().then((function(){n({type:"graph",payload:a})}))}}),[e,t,n])}(null===g||void 0===g||null===(t=g.advise)||void 0===t||null===(n=t.initProject)||void 0===n||null===(r=n.requirements)||void 0===r?void 0:r.packages,null===g||void 0===g||null===(i=g.advise)||void 0===i||null===(o=i.initProject)||void 0===o||null===(s=o.requirements_locked)||void 0===s?void 0:s.default),function(e,t){var n=Object(a.useContext)(xt);Object(a.useEffect)((function(){if(e&&t){var a={all:{},roots:{}},r={total:void 0,all:{}};Object.keys(t).forEach((function(t){var n=e.graphSearch(e.nodes.get(t));Array.from(n).forEach((function(e){var n,i,o,c,s,l,d,u,j=0===e.value.depth||t===e.value.id?"roots":1===e.value.depth?"direct":"indirect";a={all:Object(N.a)(Object(N.a)({},a.all),{},Object(nt.a)({},j,(null!==(n=a.all[j])&&void 0!==n?n:0)+1)),roots:Object(N.a)(Object(N.a)({},a.roots),{},Object(nt.a)({},t,Object(N.a)(Object(N.a)({},null!==(i=a.roots[t])&&void 0!==i?i:null),{},Object(nt.a)({},j,(null!==(o=null===(c=a.roots)||void 0===c||null===(s=c[t])||void 0===s?void 0:s[j])&&void 0!==o?o:0)+1))))},r={total:(null!==(l=r.total)&&void 0!==l?l:0)+1,root:null!==(d=r.root)&&void 0!==d?d:e.value.metadata.license,all:Object(N.a)(Object(N.a)({},r.all),{},Object(nt.a)({},e.value.metadata.license,Object(N.a)(Object(N.a)({},null!==(u=r.all[e.value.metadata.license])&&void 0!==u?u:null),{},Object(nt.a)({},e.value.label,e.value.depth))))}}))})),n({type:"metric",metric:"dependencies",payload:a}),n({type:"metric",metric:"licenses",payload:r})}}),[e,n,t])}(g.graph,null===g||void 0===g||null===(l=g.advise)||void 0===l||null===(d=l.initProject)||void 0===d||null===(v=d.requirements)||void 0===v?void 0:v.packages);return Object(b.jsxs)("div",{className:m.root,children:[(null===g||void 0===g?void 0:g.focus)?Object(b.jsx)(ze,{}):Object(b.jsx)(He,{adviseID:O.analysis_id}),null===g||void 0===g||null===(f=g.roots)||void 0===f?void 0:f.map((function(e){return e.error?Object(b.jsx)(j.a,{color:"error",gutterBottom:!0,variant:"body2",children:e.error}):null})),Object(b.jsxs)(ut.a,{value:w,onChange:function(e,t){C(t)},indicatorColor:"primary",textColor:"primary",children:[Object(b.jsx)(jt.a,{label:"Overview"}),Object(b.jsx)(jt.a,{label:"Dependencies"})]}),Object(b.jsx)(B,{value:w,index:0,children:Object(b.jsx)(_e,{})}),Object(b.jsx)(B,{value:w,index:1,children:Object(b.jsx)(dt,{})})]})},ft=function(){return Object(b.jsxs)(u.c,{children:[Object(b.jsx)(u.a,{exact:!0,path:"/",component:G}),Object(b.jsx)(u.a,{exact:!0,path:"/dashboard/:analysis_id",component:vt}),Object(b.jsx)(u.a,{path:"*",status:404,children:Object(b.jsx)(v,{})})]})},pt=n(235),ht=n(236);function mt(e,t){switch(t.type){case"graph":return Object(N.a)(Object(N.a)({},e),{},{graph:t.payload});case"metric":return Object(N.a)(Object(N.a)({},e),{},{metrics:Object(N.a)(Object(N.a)({},e.metrics),{},Object(nt.a)({},t.metric,t.payload))});case"error":return Object(N.a)(Object(N.a)({},e),{},{error:t.payload});case"advise":return Object(N.a)(Object(N.a)({},e),{},{advise:Object(N.a)(Object(N.a)({},e.advise),{},Object(nt.a)({},t.param,t.payload))});case"packageWarning":return Object(N.a)(Object(N.a)({},e),{},{packageWarning:t.payload});case"reset":return Ot;default:return e}}var Ot={},gt=r.a.createContext(),xt=r.a.createContext();var yt=function(){var e=Object(a.useReducer)(mt,Ot),t=Object(c.a)(e,2),n=t[0],r=t[1];return Object(b.jsxs)(pt.a,{theme:l,children:[Object(b.jsx)(ht.a,{}),Object(b.jsx)(d.a,{basename:"/thoth-search",children:Object(b.jsx)(gt.Provider,{value:n,children:Object(b.jsx)(xt.Provider,{value:r,children:Object(b.jsx)(ft,{})})})})]})};o.a.render(Object(b.jsx)(r.a.StrictMode,{children:Object(b.jsx)(yt,{})}),document.getElementById("root"))}},[[172,1,2]]]);
//# sourceMappingURL=main.44c1aaf8.chunk.js.map